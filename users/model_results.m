function varargout = model_results(varargin)
% MODEL_RESULTS M-file for model_results.fig
%      MODEL_RESULTS, by itself, creates a new MODEL_RESULTS or raises the existing
%      singleton*.
%
%      H = MODEL_RESULTS returns the handle to a new MODEL_RESULTS or the handle to
%      the existing singleton*.
%
%      MODEL_RESULTS('CALLBACK',hObject,eventData,handles,...) calls the local
%      function named CALLBACK in MODEL_RESULTS.M with the given input arguments.
%
%      MODEL_RESULTS('Property','Value',...) creates a new MODEL_RESULTS or raises the
%      existing singleton*.  Starting from the left, property value pairs are
%      applied to the GUI before model_results_OpeningFcn gets called.  An
%      unrecognized property name or invalid value makes property application
%      stop.  All inputs are passed to model_results_OpeningFcn via varargin.
%
%      *See GUI Options on GUIDE's Tools menu.  Choose "GUI allows only one
%      instance to run (singleton)".
%
% See also: GUIDE, GUIDATA, GUIHANDLES

% Edit the above text to modify the response to help model_results

% Last Modified by GUIDE v2.5 24-Jan-2014 16:05:01

% Begin initialization code - DO NOT EDIT
gui_Singleton = 1;
gui_State = struct('gui_Name',       mfilename, ...
                   'gui_Singleton',  gui_Singleton, ...
                   'gui_OpeningFcn', @model_results_OpeningFcn, ...
                   'gui_OutputFcn',  @model_results_OutputFcn, ...
                   'gui_LayoutFcn',  [] , ...
                   'gui_Callback',   []);
if nargin && ischar(varargin{1})
    gui_State.gui_Callback = str2func(varargin{1});
end

if nargout
    [varargout{1:nargout}] = gui_mainfcn(gui_State, varargin{:});
else
    gui_mainfcn(gui_State, varargin{:});
end
% End initialization code - DO NOT EDIT


% --- Executes just before model_results is made visible.
function model_results_OpeningFcn(hObject, eventdata, handles, varargin)
% This function has no output args, see OutputFcn.
% hObject    handle to figure
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)
% varargin   command line arguments to model_results (see VARARGIN)

% Choose default command line output for model_results

% Code Library Paths
addpath('./LOCAL_CODES/');
addpath('./LOCAL_CODES/CANOPY/');
addpath('./LOCAL_CODES/ROOT_SOIL/');
addpath('./LOCAL_CODES/ROOT_SOIL/IMPLICIT');
addpath('./LOCAL_CODES/ROOT_SOIL/CN_MODEL');
addpath('./LOCAL_CODES/NUMERICAL/');
addpath('./LOCAL_CODES/PLOTTING/');


handles.output = hObject;
figcount_TSF    = 1000;
figcount_DAF    = 2000;
figcount_TSCP   = 3000;
figcount_DACP   = 4000;

figcount_TSFN    = 5000;
figcount_DAFN    = 6000;
figcount_TSSP    = 7000;
figcount_DASP    = 8000;

setappdata(0,'figcount_TSF',figcount_TSF);
setappdata(0,'figcount_DAF',figcount_DAF);
setappdata(0,'figcount_TSCP',figcount_TSCP);
setappdata(0,'figcount_DACP',figcount_DACP);

setappdata(0,'figcount_TSFN',figcount_TSFN);
setappdata(0,'figcount_DAFN',figcount_DAFN);
setappdata(0,'figcount_TSSP',figcount_TSSP);
setappdata(0,'figcount_DASP',figcount_DASP);

set(handles.pan_result_canopy,'Visible','on');
set(handles.pan_result_nutrient,'Visible','off');

button_load_picture(hObject, eventdata, handles);
% Update handles structure
guidata(hObject, handles);

% UIWAIT makes model_results wait for user response (see UIRESUME)
% uiwait(handles.figure1);


% --- Outputs from this function are returned to the command line.
function varargout = model_results_OutputFcn(hObject, eventdata, handles) 
% varargout  cell array for returning output args (see VARARGOUT);
% hObject    handle to figure
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Get default command line output from handles structure
varargout{1} = handles.output;


function axes1_CreateFcn(hObject, eventdata, handles)
resulticonsmall = imread('./users/icons/result_small.png');
image(resulticonsmall);
axis off
%imshow('./users/icons/result_small.png');


function resu_but_load_Callback(hObject, eventdata, handles)
[filename, pathname] = uigetfile('Result_*.mat', 'Open result files');
%[filename, pathname] = uigetfile('*.mat', 'Open result files');
if pathname == 0 %if the user pressed cancelled, then we exit this callback
    return
else
    fullpath_result = [pathname,filename];
    set(handles.resu_txt_load,'String',fullpath_result);
    %
    % Load information from model_forcings file
%            'decyear'           , 'hour'            , 'timevect'        , 'zhc'             ,   ...
%            'U_in'              , 'VPD_in'          , 'ZEN_in'          , 'ea_in'           ,   ...
%            'rpp_weight_store'  , 'smp_weight_store', 'ustar_in'        ,                       ...
%     load (fullpath_result,...
%             'year'              , 'doy'             , 'hour'            , 'decdoy'          ,   ...
%             'decyear'           , 'hour'            , 'timevect'        , 'zhc'             ,   ...
%             'PARAMS'            , 'Soil_nutrient'   ,   ...                      
%             ...
%             ...
%             'An_can_store'      , 'Ch2o_canopy'     , 'Ci_mean'         , 'E_soil_store'    ,   ...
%             'Evap_canopy'       , 'Fc_eco_store'    , 'Fc_soil_store'   , 'G_store'         ,   ...
%             'H_can_store'       , 'H_eco_store'     , 'H_soil_store'    , 'LAI_in'          ,   ...
%             'LE_can_store'      , 'LE_eco_store'    , 'LE_soil_store'   , 'LWout_store'     ,   ...
%             'PPT_in'            , 'Pa_in'           , 'RH_soil_store'   , 'Rg_in'           ,   ...
%             'Rnrad_can_store'   , 'Rnrad_eco_store' , 'Rnrad_soil_store', 'SWout_store'     ,   ...
%             'Sh2o_canopy'       , 'TR_can_store'    , 'Ta_in'           , 'Tl_mean'         ,   ...
%             'U_in'              , 'VPD_in'          , 'ZEN_in'          , 'ea_in'           ,   ...
%             'fdiff_store'       , 'fsv_mean'        , 'psil_mean'       ,                       ...
%             'rpp_weight_store'  , 'smp_weight_store',                                           ...
%             ...
%             ...
%             'An_diurnal_can'    , 'An_std_can'      , 'Ch2o_diurnal_mod', 'Ch2o_std_mod'    ,   ...
%             'Ci_diurnal_mod'    , 'Ci_std_mod'      , 'Evap_diurnal_mod', 'Evap_std_mod'    ,   ...
%             'Fc_diurnal_eco'    , 'Fc_std_eco'      , 'Fc_diurnal_soil' , 'Fc_std_soil'     ,   ...
%             'G_diurnal_mod'     , 'G_std_mod'       , 'H_diurnal_can'   , 'H_std_can'       ,   ...
%             'H_diurnal_eco'     , 'H_std_eco'       , 'H_diurnal_soil'  , 'H_std_soil'      ,   ...
%             'LE_diurnal_can'    , 'LE_std_can'      , 'LE_diurnal_eco'  , 'LE_std_eco'      ,   ...
%             'LE_diurnal_soil'   , 'LE_std_soil'     , 'Rn_diurnal_can'  , 'Rn_std_can'      ,   ...
%             'Rn_diurnal_eco'    , 'Rn_std_eco'      , 'Rn_diurnal_soil' , 'Rn_std_soil'     ,   ...
%             'Sh2o_diurnal_mod'  , 'Sh2o_std_mod'    , 'Tl_diurnal_mod'  , 'Tl_std_mod'      ,   ...
%             'psil_diurnal_mod'  , 'psil_std_mod'    , 'hr'              ,                       ...
%             ...
%             ...
%             'An_canopy_norm_prof'       , 'An_canopy_prof'          , 'An_shade_norm_prof'      ,...
%             'An_shade_prof'             , 'An_sun_norm_prof'        , 'An_sun_prof'             ,...
%             'CAz_prof'                  , 'Ch2o_canopy_prof'        , 'Ci_canopy_prof'          ,...
%             'Ci_shade_prof'             , 'Ci_sun_prof'             , 'EAz_prof'                ,...
%             'Evap_canopy_prof'          , 'H_canopy_norm_prof'      , 'H_canopy_prof'           ,...
%             'H_shade_norm_prof'         , 'H_shade_prof'            , 'H_sun_norm_prof'         ,...
%             'H_sun_prof'                , 'LAI_shade_prof'          , 'LAI_sun_prof'            ,...
%             'LE_canopy_norm_prof'       , 'LE_canopy_prof'          , 'LE_shade_norm_prof'      ,...
%             'LE_shade_prof'             , 'LE_sun_norm_prof'        , 'LE_sun_prof'             ,...
%             'LWabs_can_prof'            , 'LWemit_can_prof'         , 'NIRabs_canopy_norm_prof' ,...
%             'NIRabs_canopy_prof'        , 'NIRabs_sun_norm_prof'    , 'NIRabs_sun_prof'         ,...
%             'PARabs_canopy_norm_prof'   , 'PARabs_shade_norm_prof'  , 'PARabs_sun_norm_prof'    ,...
%             'PARabs_sun_prof'           , 'Rnrad_canopy_norm_prof'  , 'Rnrad_canopy_prof'       ,...
%             'Rnrad_shade_norm_prof'     , 'Rnrad_shade_prof'        , 'Rnrad_sun_norm_prof'     ,...
%             'Rnrad_sun_prof'            , 'Sh2o_canopy_prof'        , 'TAz_prof'                ,...
%             'Tl_canopy_prof'            , 'Tl_shade_Ta_Diff'        , 'Tl_shade_prof'           ,...
%             'Tl_sun_Ta_Diff'            , 'Tl_sun_prof'             , 'Uz_prof'              	,...
%             'dryfrac_prof'              , 'fshade_prof'             , 'fsun_prof'               ,...
%             'fsv_canopy_prof'           , 'fsv_shade_prof'          , 'fsv_sun_prof'            ,...
%             'gbh_canopy_prof'           , 'gbh_shade_prof'          , 'gbh_sun_prof'            ,...
%             'gbv_canopy_prof'           , 'gbv_shade_prof'          , 'gbv_sun_prof'            ,...
%             'gsv_canopy_prof'           , 'gsv_shade_prof'          , 'gsv_sun_prof'            ,...
%             'psil_canopy_prof'          , 'psil_shade_prof'       	, 'psil_sun_prof'           ,...
%             ...
%             ...
%             'An_canopy_diurnal_prof'    , 'An_canopy_std_prof'      , 'An_shade_diurnal_prof'   ,...
%             'An_shade_std_prof'         , 'An_sun_diurnal_prof'     , 'An_sun_std_prof'         ,...
%             'CAz_diurnal_prof'          , 'CAz_std_prof'            , 'Ch2o_canopy_diurnal_prof',...
%             'Ch2o_canopy_std_prof'     	, 'Ci_canopy_diurnal_prof'  , 'Ci_canopy_std_prof'      ,...
%             'Ci_shade_diurnal_prof'     , 'Ci_shade_std_prof'       , 'Ci_sun_diurnal_prof'     ,...
%             'Ci_sun_std_prof'           , 'EAz_diurnal_prof'        , 'EAz_std_prof'            ,...
%             'H_canopy_diurnal_prof'     , 'H_canopy_std_prof'       , 'H_shade_diurnal_prof'    ,...
%             'H_shade_std_prof'          , 'H_sun_diurnal_prof'     , 'H_sun_std_prof'           ,...
%             'LE_canopy_diurnal_prof'    , 'LE_canopy_std_prof'      , 'LE_shade_diurnal_prof'   ,...
%             'LE_shade_std_prof'         , 'LE_sun_diurnal_prof'     , 'LE_sun_std_prof'         ,...
%             'LWabs_can_diurnal_prof'    , 'LWabs_can_std_prof'      , 'LWemit_can_diurnal_prof' ,...
%             'LWemit_can_std_prof'       , 'NIRabs_canopy_diurnal_prof','NIRabs_canopy_std_prof' ,...
%             'NIRabs_shade_diurnal_prof' , 'NIRabs_shade_std_prof'   , 'NIRabs_sun_diurnal_prof' ,...
%             'NIRabs_sun_std_prof'       , 'PARabs_canopy_diurnal_prof','PARabs_canopy_std_prof' ,...
%             'PARabs_shade_diurnal_prof' , 'PARabs_shade_std_prof'   , 'PARabs_sun_diurnal_prof' ,...
%             'PARabs_sun_std_prof'       , 'Rnrad_canopy_diurnal_prof','Rnrad_canopy_std_prof'   ,...
%             'Rnrad_shade_diurnal_prof'  , 'Rnrad_shade_std_prof'    , 'Rnrad_sun_diurnal_prof'  ,...
%             'Rnrad_sun_std_prof'        , 'Sh2o_canopy_diurnal_prof', 'Sh2o_canopy_std_prof'    ,...
%             'TAz_diurnal_prof'          , 'TAz_std_prof'            , 'Tl_canopy_diurnal_prof'  ,...
%             'Tl_canopy_std_prof'        , 'Tl_shade_diurnal_prof'   , 'Tl_shade_std_prof'       ,...
%             'Tl_sun_diurnal_prof'       , 'Tl_sun_std_prof'         , 'TlmTa_canopy_diurnal_prof',...
%             'TlmTa_canopy_std_prof'     , 'TlmTa_shade_diurnal_prof', 'TlmTa_shade_std_prof'    ,...
%             'TlmTa_sun_diurnal_prof'    , 'TlmTa_sun_std_prof'      , 'Uz_diurnal_prof'         ,...
%             'Uz_std_prof'               , 'dryfrac_diurnal_prof'    , 'dryfrac_std_prof'        ,...
%             'fshade_diurnal_prof'       , 'fshade_std_prof'         , 'fsun_diurnal_prof'       ,...
%             'fsun_std_prof'             , 'gbv_canopy_diurnal_prof' , 'gbv_canopy_std_prof'     ,...
%             'gbv_shade_diurnal_prof'    , 'gbv_shade_std_prof'      , 'gbv_sun_diurnal_prof'    ,...
%             'gbv_sun_std_prof'          , 'gsv_canopy_diurnal_prof' , 'gsv_canopy_std_prof'     ,...
%             'gsv_shade_diurnal_prof'    , 'gsv_shade_std_prof'      , 'gsv_sun_diurnal_prof'    ,...
%             'gsv_sun_std_prof'          , 'wetfrac_diurnal_prof'    , 'wetfrac_std_prof'        );
    load (fullpath_result,...
            'year'              , 'doy'             , 'hour'            , 'decdoy'          ,   ...
            'decyear'           , 'hour'            , 'timevect'        , 'zhc'             ,   ...
            'PARAMS'            , 'Soil_nutrient'   ,   ...                      
            ...
            ...
            'An_can_store'      , 'Ch2o_canopy'     , 'Ci_mean'         , 'E_soil_store'    ,   ...
            'Evap_canopy'       , 'Fc_eco_store'    , 'Fc_soil_store'   , 'G_store'         ,   ...
            'H_can_store'       , 'H_eco_store'     , 'H_soil_store'    , 'LAI_in'          ,   ...
            'LE_can_store'      , 'LE_eco_store'    , 'LE_soil_store'   , 'LWout_store'     ,   ...
            'PPT_in'            , 'Pa_in'           , 'RH_soil_store'   , 'Rg_in'           ,   ...
            'Rnrad_can_store'   , 'Rnrad_eco_store' , 'Rnrad_soil_store', 'SWout_store'     ,   ...
            'Sh2o_canopy'       , 'TR_can_store'    , 'Ta_in'           , 'Tl_mean'         ,   ...
            'U_in'              , 'VPD_in'          , 'ZEN_in'          , 'ea_in'           ,   ...
            'fdiff_store'       , 'fsv_mean'        , 'psil_mean'       ,                       ...
            'rpp_weight_store'  , 'smp_weight_store',                                           ...
            ...
            ...
            'An_diurnal_can'    , 'An_std_can'      , 'Ch2o_diurnal_mod', 'Ch2o_std_mod'    ,   ...
            'Ci_diurnal_mod'    , 'Ci_std_mod'      , 'Evap_diurnal_mod', 'Evap_std_mod'    ,   ...
            'Fc_diurnal_eco'    , 'Fc_std_eco'      , 'Fc_diurnal_soil' , 'Fc_std_soil'     ,   ...
            'G_diurnal_mod'     , 'G_std_mod'       , 'H_diurnal_can'   , 'H_std_can'       ,   ...
            'H_diurnal_eco'     , 'H_std_eco'       , 'H_diurnal_soil'  , 'H_std_soil'      ,   ...
            'LE_diurnal_can'    , 'LE_std_can'      , 'LE_diurnal_eco'  , 'LE_std_eco'      ,   ...
            'LE_diurnal_soil'   , 'LE_std_soil'     , 'Rn_diurnal_can'  , 'Rn_std_can'      ,   ...
            'Rn_diurnal_eco'    , 'Rn_std_eco'      , 'Rn_diurnal_soil' , 'Rn_std_soil'     ,   ...
            'Sh2o_diurnal_mod'  , 'Sh2o_std_mod'    , 'Tl_diurnal_mod'  , 'Tl_std_mod'      ,   ...
            'psil_diurnal_mod'  , 'psil_std_mod'    , 'hr'              ,                       ...
            ...
            ...
            'An_canopy_norm_prof'       , 'An_canopy_prof'          , 'An_shade_norm_prof'      ,...
            'An_shade_prof'             , 'An_sun_norm_prof'        , 'An_sun_prof'             ,...
            'CAz_prof'                  , 'Ch2o_canopy_prof'        , 'Ci_canopy_prof'          ,...
            'Ci_shade_prof'             , 'Ci_sun_prof'             , 'EAz_prof'                ,...
            'Evap_canopy_prof'          , 'H_canopy_norm_prof'      , 'H_canopy_prof'           ,...
            'H_shade_norm_prof'         , 'H_shade_prof'            , 'H_sun_norm_prof'         ,...
            'H_sun_prof'                , 'LAI_shade_prof'          , 'LAI_sun_prof'            ,...
            'LE_canopy_norm_prof'       , 'LE_canopy_prof'          , 'LE_shade_norm_prof'      ,...
            'LE_shade_prof'             , 'LE_sun_norm_prof'        , 'LE_sun_prof'             ,...
            'LWabs_can_prof'            , 'LWemit_can_prof'         , 'NIRabs_canopy_norm_prof' ,...
            'NIRabs_canopy_prof'        , 'NIRabs_sun_norm_prof'    , 'NIRabs_sun_prof'         ,...
            'PARabs_canopy_norm_prof'   , 'PARabs_shade_norm_prof'  , 'PARabs_sun_norm_prof'    ,...
            'PARabs_sun_prof'           , 'Rnrad_canopy_norm_prof'  , 'Rnrad_canopy_prof'       ,...
            'Rnrad_shade_norm_prof'     , 'Rnrad_shade_prof'        , 'Rnrad_sun_norm_prof'     ,...
            'Rnrad_sun_prof'            , 'Sh2o_canopy_prof'        , 'TAz_prof'                ,...
            'Tl_canopy_prof'            , 'Tl_shade_Ta_Diff'        , 'Tl_shade_prof'           ,...
            'Tl_sun_Ta_Diff'            , 'Tl_sun_prof'             , 'Uz_prof'              	,...
            'dryfrac_prof'              , 'fshade_prof'             , 'fsun_prof'               ,...
            'gbh_canopy_prof'           , 'gbh_shade_prof'          , 'gbh_sun_prof'            ,...
            'gbv_canopy_prof'           , 'gbv_shade_prof'          , 'gbv_sun_prof'            ,...
            'gsv_canopy_prof'           , 'gsv_shade_prof'          , 'gsv_sun_prof'            ,...
            'psil_canopy_prof'          , 'psil_shade_prof'       	, 'psil_sun_prof'           ,...
            ...
            ...
            'An_canopy_diurnal_prof'    , 'An_canopy_std_prof'      , 'An_shade_diurnal_prof'   ,...
            'An_shade_std_prof'         , 'An_sun_diurnal_prof'     , 'An_sun_std_prof'         ,...
            'CAz_diurnal_prof'          , 'CAz_std_prof'            , 'Ch2o_canopy_diurnal_prof',...
            'Ch2o_canopy_std_prof'     	, 'Ci_canopy_diurnal_prof'  , 'Ci_canopy_std_prof'      ,...
            'Ci_shade_diurnal_prof1'    , 'Ci_shade_diurnal_prof2'  , 'Ci_shade_diurnal_prof3'  , 'Ci_shade_diurnal_prof4' , ... 
            'Ci_shade_std_prof1'        , 'Ci_shade_std_prof2'      , 'Ci_shade_std_prof3'      , 'Ci_shade_std_prof4'     , ... 
            'Ci_sun_diurnal_prof1'      , 'Ci_sun_diurnal_prof2'    , 'Ci_sun_diurnal_prof3'    , 'Ci_sun_diurnal_prof4'   , ...
            'Ci_sun_std_prof1'          , 'Ci_sun_std_prof2'        , 'Ci_sun_std_prof3'        , 'Ci_sun_std_prof4'       , ... 
            'EAz_diurnal_prof'          , 'EAz_std_prof'            ,...
            'H_canopy_diurnal_prof'     , 'H_canopy_std_prof'       , 'H_shade_diurnal_prof'    ,...
            'H_shade_std_prof'          , 'H_sun_diurnal_prof'      , 'H_sun_std_prof'           ,...
            'LE_canopy_diurnal_prof'    , 'LE_canopy_std_prof'      , 'LE_shade_diurnal_prof'   ,...
            'LE_shade_std_prof'         , 'LE_sun_diurnal_prof'     , 'LE_sun_std_prof'         ,...
            'LWabs_can_diurnal_prof'    , 'LWabs_can_std_prof'      , 'LWemit_can_diurnal_prof' ,...
            'LWemit_can_std_prof'       , 'NIRabs_canopy_diurnal_prof','NIRabs_canopy_std_prof' ,...
            'NIRabs_shade_diurnal_prof' , 'NIRabs_shade_std_prof'   , 'NIRabs_sun_diurnal_prof' ,...
            'NIRabs_sun_std_prof'       , 'PARabs_canopy_diurnal_prof','PARabs_canopy_std_prof' ,...
            'PARabs_shade_diurnal_prof' , 'PARabs_shade_std_prof'   , 'PARabs_sun_diurnal_prof' ,...
            'PARabs_sun_std_prof'       , 'Rnrad_canopy_diurnal_prof','Rnrad_canopy_std_prof'   ,...
            'Rnrad_shade_diurnal_prof'  , 'Rnrad_shade_std_prof'    , 'Rnrad_sun_diurnal_prof'  ,...
            'Rnrad_sun_std_prof'        , 'Sh2o_canopy_diurnal_prof', 'Sh2o_canopy_std_prof'    ,...
            'TAz_diurnal_prof'          , 'TAz_std_prof'            , 'Tl_canopy_diurnal_prof'  ,...
            'Tl_canopy_std_prof'        , ...
            'Tl_shade_diurnal_prof1'    , 'Tl_shade_diurnal_prof2'  , 'Tl_shade_diurnal_prof3'  , 'Tl_shade_diurnal_prof4'  , ... 
            'Tl_shade_std_prof1'        , 'Tl_shade_std_prof2'      , 'Tl_shade_std_prof3'      , 'Tl_shade_std_prof4'      , ...
            'Tl_sun_diurnal_prof1'      , 'Tl_sun_diurnal_prof2'    , 'Tl_sun_diurnal_prof3'    , 'Tl_sun_diurnal_prof4'    , ...
            'Tl_sun_std_prof1'          , 'Tl_sun_std_prof2'        , 'Tl_sun_std_prof3'        , 'Tl_sun_std_prof4'        , ... 
            'TlmTa_canopy_diurnal_prof' , ...
            'TlmTa_canopy_std_prof'     , ... 
            'TlmTa_shade_diurnal_prof1' ,'TlmTa_shade_diurnal_prof2','TlmTa_shade_diurnal_prof3','TlmTa_shade_diurnal_prof4', ... 
            'TlmTa_shade_std_prof1'     , 'TlmTa_shade_std_prof2'   , 'TlmTa_shade_std_prof3'   , 'TlmTa_shade_std_prof4'   , ...
            'TlmTa_sun_diurnal_prof1'   , 'TlmTa_sun_diurnal_prof2' , 'TlmTa_sun_diurnal_prof3' , 'TlmTa_sun_diurnal_prof4' , ... 
            'TlmTa_sun_std_prof1'       , 'TlmTa_sun_std_prof2'     , 'TlmTa_sun_std_prof3'     , 'TlmTa_sun_std_prof4'     , ...
            'Uz_diurnal_prof'           ,...
            'Uz_std_prof'               , 'dryfrac_diurnal_prof'    , 'dryfrac_std_prof'        ,...
            'fshade_diurnal_prof'       , 'fshade_std_prof'         , 'fsun_diurnal_prof'       ,...
            'fsun_std_prof'             , 'gbv_canopy_diurnal_prof' , 'gbv_canopy_std_prof'     ,...
            'gbv_shade_diurnal_prof1'   , 'gbv_shade_diurnal_prof2' , 'gbv_shade_diurnal_prof3' , 'gbv_shade_diurnal_prof4' , ... 
            'gbv_shade_std_prof1'       , 'gbv_shade_std_prof2'     , 'gbv_shade_std_prof3'     , 'gbv_shade_std_prof4'     , ... 
            'gbv_sun_diurnal_prof1'     , 'gbv_sun_diurnal_prof2'   , 'gbv_sun_diurnal_prof3'   , 'gbv_sun_diurnal_prof4'   , ...
            'gbv_sun_std_prof1'         , 'gbv_sun_std_prof2'       , 'gbv_sun_std_prof3'       , 'gbv_sun_std_prof4'       , ... 
            'gsv_canopy_diurnal_prof'   , 'gsv_canopy_std_prof'     ,...
            'gsv_shade_diurnal_prof1'   , 'gsv_shade_diurnal_prof2' , 'gsv_shade_diurnal_prof3' , 'gsv_shade_diurnal_prof4' , ... 
            'gsv_shade_std_prof1'       , 'gsv_shade_std_prof2'     , 'gsv_shade_std_prof3'     , 'gsv_shade_std_prof4'     , ... 
            'gsv_sun_diurnal_prof1'     , 'gsv_sun_diurnal_prof2'   , 'gsv_sun_diurnal_prof3'   , 'gsv_sun_diurnal_prof4'   , ...
            'gsv_sun_std_prof1'         , 'gsv_sun_std_prof2'       , 'gsv_sun_std_prof3'       , 'gsv_sun_std_prof4'       , ...
            'wetfrac_diurnal_prof'      , 'wetfrac_std_prof'        );
        
% 	TSF_variable = [...             
%             An_can_store        , Ch2o_canopy       , Ci_mean           , E_soil_store      ,   ...
%             Evap_canopy         , Fc_eco_store      , Fc_soil_store     , G_store           ,   ...
%             H_can_store         , H_eco_store       , H_soil_store      , LAI_in            ,   ...
%             LE_can_store        , LE_eco_store      , LE_soil_store     , LWout_store       ,   ...
%             PPT_in              , Pa_in             , RH_soil_store     , Rg_in             ,   ...
%             Rnrad_can_store     , Rnrad_eco_store   , Rnrad_soil_store  , SWout_store       ,   ...
%             Sh2o_canopy         , TR_can_store      , Ta_in             , Tl_mean           ,   ...
%             U_in                , VPD_in            , ZEN_in            ,                       ...
%             ea_in               , fdiff_store       , fsv_mean          , psil_mean         ,   ...
%             rpp_weight_store    , smp_weight_store  , ustar_in          ];  
%         
%     setappdata(0,'TSF_variable',TSF_variable);
%     setappdata(0,'hr',hr);

    if size(LAI_in,2) == 1
        LAI_in1=LAI_in(:,1)';
        LAI_in2=nan.*ones(1,size(LAI_in,1));
        LAI_in3=nan.*ones(1,size(LAI_in,1));
        LAI_in4=nan.*ones(1,size(LAI_in,1));

        rpp_weight_store1=rpp_weight_store(:,:,1);
        rpp_weight_store2=nan.*ones(1,size(LAI_in,1));
        rpp_weight_store3=nan.*ones(1,size(LAI_in,1));
        rpp_weight_store4=nan.*ones(1,size(LAI_in,1));
    elseif size(LAI_in,2) == 2
        LAI_in1=LAI_in(:,1)';
        LAI_in2=LAI_in(:,2)';
        LAI_in3=nan.*ones(1,size(LAI_in,1));
        LAI_in4=nan.*ones(1,size(LAI_in,1));

        rpp_weight_store1=rpp_weight_store(:,:,1);
        rpp_weight_store2=rpp_weight_store(:,:,2);
        rpp_weight_store3=nan.*ones(1,size(LAI_in,1));
        rpp_weight_store4=nan.*ones(1,size(LAI_in,1));
    elseif size(LAI_in,2) == 3
        LAI_in1=LAI_in(:,1)';
        LAI_in2=LAI_in(:,2)';
        LAI_in3=LAI_in(:,3)';
        LAI_in4=nan.*ones(1,size(LAI_in,1));

        rpp_weight_store1=rpp_weight_store(:,:,1);
        rpp_weight_store2=rpp_weight_store(:,:,2);
        rpp_weight_store3=rpp_weight_store(:,:,3);
        rpp_weight_store4=nan.*ones(1,size(LAI_in,1));
    elseif size(LAI_in,2) == 4
        LAI_in1=LAI_in(:,1)';
        LAI_in2=LAI_in(:,2)';
        LAI_in3=LAI_in(:,3)';
        LAI_in4=LAI_in(:,4)';

        rpp_weight_store1=rpp_weight_store(:,:,1);
        rpp_weight_store2=rpp_weight_store(:,:,2);
        rpp_weight_store3=rpp_weight_store(:,:,3);
        rpp_weight_store4=rpp_weight_store(:,:,4);
    end
    
	TSF_variable = [...             
            An_can_store'        , Ch2o_canopy'       , Ci_mean'           , E_soil_store'      ,   ...
            Evap_canopy'         , Fc_eco_store'      , Fc_soil_store'     , G_store'           ,   ...
            H_can_store'         , H_eco_store'       , H_soil_store'      , ...
            LAI_in1'             , LAI_in2'           , LAI_in3'           , LAI_in4'           ,  ...
            LE_can_store'        , LE_eco_store'      , LE_soil_store'     , LWout_store'       ,   ...
            PPT_in               , Pa_in              , RH_soil_store'     , Rg_in              ,   ...
            Rnrad_can_store'     , Rnrad_eco_store'   , Rnrad_soil_store'  , SWout_store'       ,   ...
            Sh2o_canopy'         , TR_can_store'      , Ta_in              , Tl_mean'           ,   ...
            U_in                 , VPD_in             , ZEN_in             ,                       ...
            ea_in                , fdiff_store'       , fsv_mean'          , psil_mean'         ,   ...
            rpp_weight_store1'   , rpp_weight_store2' , rpp_weight_store3' , rpp_weight_store4' ,   ... 
            smp_weight_store'  ];  
        
        setappdata(0,'TSF_variable',TSF_variable);
        setappdata(0,'hr',hr);
        
%     DAF_variable = [...
%             An_diurnal_can      ; An_std_can        ; Ch2o_diurnal_mod  ; Ch2o_std_mod      ;   ...
%             Ci_diurnal_mod      ; Ci_std_mod      	; Evap_diurnal_mod  ; Evap_std_mod      ;   ...
%             Fc_diurnal_eco      ; Fc_std_eco        ; Fc_diurnal_soil   ; Fc_std_soil       ;   ...
%             G_diurnal_mod       ; G_std_mod         ; H_diurnal_can     ; H_std_can         ;   ...
%             H_diurnal_eco       ; H_std_eco         ; H_diurnal_soil    ; H_std_soil        ;   ...
%             LE_diurnal_can      ; LE_std_can        ; LE_diurnal_eco    ; LE_std_eco        ;   ...
%             LE_diurnal_soil     ; LE_std_soil       ; Rn_diurnal_can    ; Rn_std_can        ;   ...
%             Rn_diurnal_eco      ; Rn_std_eco        ; Rn_diurnal_soil   ; Rn_std_soil       ;   ...
%             Sh2o_diurnal_mod    ; Sh2o_std_mod      ; Tl_diurnal_mod    ; Tl_std_mod        ;   ...
%             psil_diurnal_mod    ; psil_std_mod      ];        
%     
% 	setappdata(0,'DAF_variable',DAF_variable);    
     
    DAF_variable = [...
            An_diurnal_can      ; An_std_can        ; Ch2o_diurnal_mod  ; Ch2o_std_mod      ;   ...
            Ci_diurnal_mod      ; Ci_std_mod      	; Evap_diurnal_mod  ; Evap_std_mod      ;   ...
            Fc_diurnal_eco      ; Fc_std_eco        ; Fc_diurnal_soil   ; Fc_std_soil       ;   ...
            G_diurnal_mod       ; G_std_mod         ; H_diurnal_can     ; H_std_can         ;   ...
            H_diurnal_eco       ; H_std_eco         ; H_diurnal_soil    ; H_std_soil        ;   ...
            LE_diurnal_can      ; LE_std_can        ; LE_diurnal_eco    ; LE_std_eco        ;   ...
            LE_diurnal_soil     ; LE_std_soil       ; Rn_diurnal_can    ; Rn_std_can        ;   ...
            Rn_diurnal_eco      ; Rn_std_eco        ; Rn_diurnal_soil   ; Rn_std_soil       ;   ...
            Sh2o_diurnal_mod    ; Sh2o_std_mod      ; Tl_diurnal_mod    ; Tl_std_mod        ;   ...
            psil_diurnal_mod    ; psil_std_mod      ];        
        setappdata(0,'DAF_variable',DAF_variable);
        
        
%     TSCP_variable = cat(3,...
%           	An_canopy_norm_prof         , An_canopy_prof            , An_shade_norm_prof        ,...
%             An_shade_prof               , An_sun_norm_prof          , An_sun_prof               ,...
%             CAz_prof                    , Ch2o_canopy_prof          , Ci_canopy_prof            ,...
%             Ci_shade_prof               , Ci_sun_prof               , EAz_prof                  ,...
%             Evap_canopy_prof            , H_canopy_norm_prof        , H_canopy_prof             ,...
%             H_shade_norm_prof           , H_shade_prof              , H_sun_norm_prof           ,...
%             H_sun_prof                  , LAI_shade_prof            , LAI_sun_prof              ,...
%             LE_canopy_norm_prof         , LE_canopy_prof            , LE_shade_norm_prof        ,...
%             LE_shade_prof               , LE_sun_norm_prof          , LE_sun_prof               ,...
%             LWabs_can_prof              , LWemit_can_prof           , NIRabs_canopy_norm_prof   ,...
%             NIRabs_canopy_prof          , NIRabs_sun_norm_prof      , NIRabs_sun_prof           ,...
%             PARabs_canopy_norm_prof     , PARabs_shade_norm_prof    , PARabs_sun_norm_prof      ,...
%             PARabs_sun_prof             , Rnrad_canopy_norm_prof    , Rnrad_canopy_prof         ,...
%             Rnrad_shade_norm_prof       , Rnrad_shade_prof          , Rnrad_sun_norm_prof       ,...
%             Rnrad_sun_prof              , Sh2o_canopy_prof          , TAz_prof                  ,...
%             Tl_canopy_prof              , Tl_shade_Ta_Diff          , Tl_shade_prof             ,...
%             Tl_sun_Ta_Diff              , Tl_sun_prof               , Uz_prof                   ,...
%             dryfrac_prof                , fshade_prof               , fsun_prof                 ,...
%             fsv_canopy_prof             , fsv_shade_prof            , fsv_sun_prof              ,...
%             gbh_canopy_prof             , gbh_shade_prof            , gbh_sun_prof              ,...
%             gbv_canopy_prof             , gbv_shade_prof            , gbv_sun_prof              ,...
%             gsv_canopy_prof             , gsv_shade_prof            , gsv_sun_prof              ,...
%             psil_canopy_prof            , psil_shade_prof       	, psil_sun_prof             );
% 
% 	setappdata(0,'TSCP_variable',TSCP_variable); 
%     setappdata(0,'timevect',timevect);
%     setappdata(0,'zhc',zhc);
%     setappdata(0,'hcan',PARAMS.CanStruc.hcan);

    if size(An_sun_norm_prof,3) == 1
        An_shade_norm_prof1 = An_shade_norm_prof(:,:,1);
        An_shade_norm_prof2 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        An_shade_norm_prof3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        An_shade_norm_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        An_sun_norm_prof1 = An_sun_norm_prof(:,:,1);
        An_sun_norm_prof2 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        An_sun_norm_prof3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        An_sun_norm_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        Ci_shade_prof1 = Ci_shade_prof(:,:,1);
        Ci_shade_prof2 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        Ci_shade_prof3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        Ci_shade_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        Ci_sun_prof1 = Ci_sun_prof(:,:,1);
        Ci_sun_prof2 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        Ci_sun_prof3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        Ci_sun_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        H_shade_norm_prof1 = H_shade_norm_prof(:,:,1);
        H_shade_norm_prof2 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        H_shade_norm_prof3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        H_shade_norm_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        H_sun_norm_prof1 = H_sun_norm_prof(:,:,1);
        H_sun_norm_prof2 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        H_sun_norm_prof3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        H_sun_norm_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        LE_shade_norm_prof1 = LE_shade_norm_prof(:,:,1);
        LE_shade_norm_prof2 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        LE_shade_norm_prof3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        LE_shade_norm_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        LE_sun_norm_prof1 = LE_sun_norm_prof(:,:,1);
        LE_sun_norm_prof2 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        LE_sun_norm_prof3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        LE_sun_norm_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        Tl_shade_Ta_Diff1 = Tl_shade_Ta_Diff(:,:,1);
        Tl_shade_Ta_Diff2 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        Tl_shade_Ta_Diff3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        Tl_shade_Ta_Diff4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        Tl_sun_Ta_Diff1 = Tl_sun_Ta_Diff(:,:,1);
        Tl_sun_Ta_Diff2 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        Tl_sun_Ta_Diff3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        Tl_sun_Ta_Diff4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        Tl_shade_prof1 = Tl_shade_prof(:,:,1);
        Tl_shade_prof2 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        Tl_shade_prof3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        Tl_shade_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        Tl_sun_prof1 = Tl_sun_prof(:,:,1);
        Tl_sun_prof2 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        Tl_sun_prof3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        Tl_sun_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        gbh_shade_prof1 = gbh_shade_prof(:,:,1);
        gbh_shade_prof2 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        gbh_shade_prof3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        gbh_shade_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        gbh_sun_prof1 = gbh_sun_prof(:,:,1);
        gbh_sun_prof2 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        gbh_sun_prof3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        gbh_sun_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        gbv_shade_prof1 = gbv_shade_prof(:,:,1);
        gbv_shade_prof2 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        gbv_shade_prof3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        gbv_shade_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        gbv_sun_prof1 = gbv_sun_prof(:,:,1);
        gbv_sun_prof2 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        gbv_sun_prof3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        gbv_sun_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        gsv_shade_prof1 = gsv_shade_prof(:,:,1);
        gsv_shade_prof2 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        gsv_shade_prof3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        gsv_shade_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        gsv_sun_prof1 = gsv_sun_prof(:,:,1);
        gsv_sun_prof2 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        gsv_sun_prof3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        gsv_sun_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        psil_shade_prof1 = psil_shade_prof(:,:,1);
        psil_shade_prof2 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        psil_shade_prof3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        psil_shade_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        psil_sun_prof1 = psil_sun_prof(:,:,1);
        psil_sun_prof2 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        psil_sun_prof3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        psil_sun_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
    elseif size(An_sun_norm_prof,3) == 2
        An_shade_norm_prof1 = An_shade_norm_prof(:,:,1);
        An_shade_norm_prof2 = An_shade_norm_prof(:,:,2);
        An_shade_norm_prof3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        An_shade_norm_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        An_sun_norm_prof1 = An_sun_norm_prof(:,:,1);
        An_sun_norm_prof2 = An_sun_norm_prof(:,:,2);
        An_sun_norm_prof3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        An_sun_norm_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        Ci_shade_prof1 = Ci_shade_prof(:,:,1);
        Ci_shade_prof2 = Ci_shade_prof(:,:,2);
        Ci_shade_prof3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        Ci_shade_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        Ci_sun_prof1 = Ci_sun_prof(:,:,1);
        Ci_sun_prof2 = Ci_sun_prof(:,:,2);
        Ci_sun_prof3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        Ci_sun_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        H_shade_norm_prof1 = H_shade_norm_prof(:,:,1);
        H_shade_norm_prof2 = H_shade_norm_prof(:,:,2);
        H_shade_norm_prof3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        H_shade_norm_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        H_sun_norm_prof1 = H_sun_norm_prof(:,:,1);
        H_sun_norm_prof2 = H_sun_norm_prof(:,:,2);
        H_sun_norm_prof3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        H_sun_norm_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        LE_shade_norm_prof1 = LE_shade_norm_prof(:,:,1);
        LE_shade_norm_prof2 = LE_shade_norm_prof(:,:,2);
        LE_shade_norm_prof3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        LE_shade_norm_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        LE_sun_norm_prof1 = LE_sun_norm_prof(:,:,1);
        LE_sun_norm_prof2 = LE_sun_norm_prof(:,:,2);
        LE_sun_norm_prof3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        LE_sun_norm_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        Tl_shade_Ta_Diff1 = Tl_shade_Ta_Diff(:,:,1);
        Tl_shade_Ta_Diff2 = Tl_shade_Ta_Diff(:,:,2);
        Tl_shade_Ta_Diff3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        Tl_shade_Ta_Diff4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        Tl_sun_Ta_Diff1 = Tl_sun_Ta_Diff(:,:,1);
        Tl_sun_Ta_Diff2 = Tl_sun_Ta_Diff(:,:,2);
        Tl_sun_Ta_Diff3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        Tl_sun_Ta_Diff4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        Tl_shade_prof1 = Tl_shade_prof(:,:,1);
        Tl_shade_prof2 = Tl_shade_prof(:,:,2);
        Tl_shade_prof3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        Tl_shade_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        Tl_sun_prof1 = Tl_sun_prof(:,:,1);
        Tl_sun_prof2 = Tl_sun_prof(:,:,2);
        Tl_sun_prof3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        Tl_sun_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        gbh_shade_prof1 = gbh_shade_prof(:,:,1);
        gbh_shade_prof2 = gbh_shade_prof(:,:,2);
        gbh_shade_prof3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        gbh_shade_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        gbh_sun_prof1 = gbh_sun_prof(:,:,1);
        gbh_sun_prof2 = gbh_sun_prof(:,:,2);
        gbh_sun_prof3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        gbh_sun_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        gbv_shade_prof1 = gbv_shade_prof(:,:,1);
        gbv_shade_prof2 = gbv_shade_prof(:,:,2);
        gbv_shade_prof3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        gbv_shade_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        gbv_sun_prof1 = gbv_sun_prof(:,:,1);
        gbv_sun_prof2 = gbv_sun_prof(:,:,2);
        gbv_sun_prof3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        gbv_sun_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        gsv_shade_prof1 = gsv_shade_prof(:,:,1);
        gsv_shade_prof2 = gsv_shade_prof(:,:,2);
        gsv_shade_prof3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        gsv_shade_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        gsv_sun_prof1 = gsv_sun_prof(:,:,1);
        gsv_sun_prof2 = gsv_sun_prof(:,:,2);
        gsv_sun_prof3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        gsv_sun_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        psil_shade_prof1 = psil_shade_prof(:,:,1);
        psil_shade_prof2 = psil_shade_prof(:,:,2);
        psil_shade_prof3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        psil_shade_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        psil_sun_prof1 = psil_sun_prof(:,:,1);
        psil_sun_prof2 = psil_sun_prof(:,:,2);
        psil_sun_prof3 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        psil_sun_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
    elseif size(An_sun_norm_prof,3) == 3
        An_shade_norm_prof1 = An_shade_norm_prof(:,:,1);
        An_shade_norm_prof2 = An_shade_norm_prof(:,:,2);
        An_shade_norm_prof3 = An_shade_norm_prof(:,:,3);
        An_shade_norm_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        An_sun_norm_prof1 = An_sun_norm_prof(:,:,1);
        An_sun_norm_prof2 = An_sun_norm_prof(:,:,2);
        An_sun_norm_prof3 = An_sun_norm_prof(:,:,3);
        An_sun_norm_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        Ci_shade_prof1 = Ci_shade_prof(:,:,1);
        Ci_shade_prof2 = Ci_shade_prof(:,:,2);
        Ci_shade_prof3 = Ci_shade_prof(:,:,3);
        Ci_shade_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        Ci_sun_prof1 = Ci_sun_prof(:,:,1);
        Ci_sun_prof2 = Ci_sun_prof(:,:,2);
        Ci_sun_prof3 = Ci_sun_prof(:,:,3);
        Ci_sun_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        H_shade_norm_prof1 = H_shade_norm_prof(:,:,1);
        H_shade_norm_prof2 = H_shade_norm_prof(:,:,2);
        H_shade_norm_prof3 = H_shade_norm_prof(:,:,3);
        H_shade_norm_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        H_sun_norm_prof1 = H_sun_norm_prof(:,:,1);
        H_sun_norm_prof2 = H_sun_norm_prof(:,:,2);
        H_sun_norm_prof3 = H_sun_norm_prof(:,:,3);
        H_sun_norm_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        LE_shade_norm_prof1 = LE_shade_norm_prof(:,:,1);
        LE_shade_norm_prof2 = LE_shade_norm_prof(:,:,2);
        LE_shade_norm_prof3 = LE_shade_norm_prof(:,:,3);
        LE_shade_norm_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        LE_sun_norm_prof1 = LE_sun_norm_prof(:,:,1);
        LE_sun_norm_prof2 = LE_sun_norm_prof(:,:,2);
        LE_sun_norm_prof3 = LE_sun_norm_prof(:,:,3);
        LE_sun_norm_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        Tl_shade_Ta_Diff1 = Tl_shade_Ta_Diff(:,:,1);
        Tl_shade_Ta_Diff2 = Tl_shade_Ta_Diff(:,:,2);
        Tl_shade_Ta_Diff3 = Tl_shade_Ta_Diff(:,:,3);
        Tl_shade_Ta_Diff4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        Tl_sun_Ta_Diff1 = Tl_sun_Ta_Diff(:,:,1);
        Tl_sun_Ta_Diff2 = Tl_sun_Ta_Diff(:,:,2);
        Tl_sun_Ta_Diff3 = Tl_sun_Ta_Diff(:,:,3);
        Tl_sun_Ta_Diff4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        Tl_shade_prof1 = Tl_shade_prof(:,:,1);
        Tl_shade_prof2 = Tl_shade_prof(:,:,2);
        Tl_shade_prof3 = Tl_shade_prof(:,:,3);
        Tl_shade_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        Tl_sun_prof1 = Tl_sun_prof(:,:,1);
        Tl_sun_prof2 = Tl_sun_prof(:,:,2);
        Tl_sun_prof3 = Tl_sun_prof(:,:,3);
        Tl_sun_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        gbh_shade_prof1 = gbh_shade_prof(:,:,1);
        gbh_shade_prof2 = gbh_shade_prof(:,:,2);
        gbh_shade_prof3 = gbh_shade_prof(:,:,3);
        gbh_shade_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        gbh_sun_prof1 = gbh_sun_prof(:,:,1);
        gbh_sun_prof2 = gbh_sun_prof(:,:,2);
        gbh_sun_prof3 = gbh_sun_prof(:,:,3);
        gbh_sun_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        gbv_shade_prof1 = gbv_shade_prof(:,:,1);
        gbv_shade_prof2 = gbv_shade_prof(:,:,2);
        gbv_shade_prof3 = gbv_shade_prof(:,:,3);
        gbv_shade_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        gbv_sun_prof1 = gbv_sun_prof(:,:,1);
        gbv_sun_prof2 = gbv_sun_prof(:,:,2);
        gbv_sun_prof3 = gbv_sun_prof(:,:,3);
        gbv_sun_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        gsv_shade_prof1 = gsv_shade_prof(:,:,1);
        gsv_shade_prof2 = gsv_shade_prof(:,:,2);
        gsv_shade_prof3 = gsv_shade_prof(:,:,3);
        gsv_shade_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        gsv_sun_prof1 = gsv_sun_prof(:,:,1);
        gsv_sun_prof2 = gsv_sun_prof(:,:,2);
        gsv_sun_prof3 = gsv_sun_prof(:,:,3);
        gsv_sun_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        psil_shade_prof1 = psil_shade_prof(:,:,1);
        psil_shade_prof2 = psil_shade_prof(:,:,2);
        psil_shade_prof3 = psil_shade_prof(:,:,3);
        psil_shade_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
        
        psil_sun_prof1 = psil_sun_prof(:,:,1);
        psil_sun_prof2 = psil_sun_prof(:,:,2);
        psil_sun_prof3 = psil_sun_prof(:,:,3);
        psil_sun_prof4 = nan.*ones(size(An_sun_norm_prof,1),size(An_sun_norm_prof,2));
    elseif size(An_sun_norm_prof,3) == 4
        An_shade_norm_prof1 = An_shade_norm_prof(:,:,1);
        An_shade_norm_prof2 = An_shade_norm_prof(:,:,2);
        An_shade_norm_prof3 = An_shade_norm_prof(:,:,3);
        An_shade_norm_prof4 = An_shade_norm_prof(:,:,4);
        
        An_sun_norm_prof1 = An_sun_norm_prof(:,:,1);
        An_sun_norm_prof2 = An_sun_norm_prof(:,:,2);
        An_sun_norm_prof3 = An_sun_norm_prof(:,:,3);
        An_sun_norm_prof4 = An_sun_norm_prof(:,:,4);

        Ci_shade_prof1 = Ci_shade_prof(:,:,1);
        Ci_shade_prof2 = Ci_shade_prof(:,:,2);
        Ci_shade_prof3 = Ci_shade_prof(:,:,3);
        Ci_shade_prof4 = Ci_shade_prof(:,:,4);
        
        Ci_sun_prof1 = Ci_sun_prof(:,:,1);
        Ci_sun_prof2 = Ci_sun_prof(:,:,2);
        Ci_sun_prof3 = Ci_sun_prof(:,:,3);
        Ci_sun_prof4 = Ci_sun_prof(:,:,4);
        
        H_shade_norm_prof1 = H_shade_norm_prof(:,:,1);
        H_shade_norm_prof2 = H_shade_norm_prof(:,:,2);
        H_shade_norm_prof3 = H_shade_norm_prof(:,:,3);
        H_shade_norm_prof4 = H_shade_norm_prof(:,:,4);
        
        H_sun_norm_prof1 = H_sun_norm_prof(:,:,1);
        H_sun_norm_prof2 = H_sun_norm_prof(:,:,2);
        H_sun_norm_prof3 = H_sun_norm_prof(:,:,3);
        H_sun_norm_prof4 = H_sun_norm_prof(:,:,4);
        
        LE_shade_norm_prof1 = LE_shade_norm_prof(:,:,1);
        LE_shade_norm_prof2 = LE_shade_norm_prof(:,:,2);
        LE_shade_norm_prof3 = LE_shade_norm_prof(:,:,3);
        LE_shade_norm_prof4 = LE_shade_norm_prof(:,:,4);
        
        LE_sun_norm_prof1 = LE_sun_norm_prof(:,:,1);
        LE_sun_norm_prof2 = LE_sun_norm_prof(:,:,2);
        LE_sun_norm_prof3 = LE_sun_norm_prof(:,:,3);
        LE_sun_norm_prof4 = LE_sun_norm_prof(:,:,4);
        
        Tl_shade_Ta_Diff1 = Tl_shade_Ta_Diff(:,:,1);
        Tl_shade_Ta_Diff2 = Tl_shade_Ta_Diff(:,:,2);
        Tl_shade_Ta_Diff3 = Tl_shade_Ta_Diff(:,:,3);
        Tl_shade_Ta_Diff4 = Tl_shade_Ta_Diff(:,:,4);
        
        Tl_sun_Ta_Diff1 = Tl_sun_Ta_Diff(:,:,1);
        Tl_sun_Ta_Diff2 = Tl_sun_Ta_Diff(:,:,2);
        Tl_sun_Ta_Diff3 = Tl_sun_Ta_Diff(:,:,3);
        Tl_sun_Ta_Diff4 = Tl_sun_Ta_Diff(:,:,4);
        
        Tl_shade_prof1 = Tl_shade_prof(:,:,1);
        Tl_shade_prof2 = Tl_shade_prof(:,:,2);
        Tl_shade_prof3 = Tl_shade_prof(:,:,3);
        Tl_shade_prof4 = Tl_shade_prof(:,:,4);
        
        Tl_sun_prof1 = Tl_sun_prof(:,:,1);
        Tl_sun_prof2 = Tl_sun_prof(:,:,2);
        Tl_sun_prof3 = Tl_sun_prof(:,:,3);
        Tl_sun_prof4 = Tl_sun_prof(:,:,4);
        
        gbh_shade_prof1 = gbh_shade_prof(:,:,1);
        gbh_shade_prof2 = gbh_shade_prof(:,:,2);
        gbh_shade_prof3 = gbh_shade_prof(:,:,3);
        gbh_shade_prof4 = gbh_shade_prof(:,:,4);
        
        gbh_sun_prof1 = gbh_sun_prof(:,:,1);
        gbh_sun_prof2 = gbh_sun_prof(:,:,2);
        gbh_sun_prof3 = gbh_sun_prof(:,:,3);
        gbh_sun_prof4 = gbh_sun_prof(:,:,4);
        
        gbv_shade_prof1 = gbv_shade_prof(:,:,1);
        gbv_shade_prof2 = gbv_shade_prof(:,:,2);
        gbv_shade_prof3 = gbv_shade_prof(:,:,3);
        gbv_shade_prof4 = gbv_shade_prof(:,:,4);
        
        gbv_sun_prof1 = gbv_sun_prof(:,:,1);
        gbv_sun_prof2 = gbv_sun_prof(:,:,2);
        gbv_sun_prof3 = gbv_sun_prof(:,:,3);
        gbv_sun_prof4 = gbv_sun_prof(:,:,4);
        
        gsv_shade_prof1 = gsv_shade_prof(:,:,1);
        gsv_shade_prof2 = gsv_shade_prof(:,:,2);
        gsv_shade_prof3 = gsv_shade_prof(:,:,3);
        gsv_shade_prof4 = gsv_shade_prof(:,:,4);
        
        gsv_sun_prof1 = gsv_sun_prof(:,:,1);
        gsv_sun_prof2 = gsv_sun_prof(:,:,2);
        gsv_sun_prof3 = gsv_sun_prof(:,:,3);
        gsv_sun_prof4 = gsv_sun_prof(:,:,4);
        
        psil_shade_prof1 = psil_shade_prof(:,:,1);
        psil_shade_prof2 = psil_shade_prof(:,:,2);
        psil_shade_prof3 = psil_shade_prof(:,:,3);
        psil_shade_prof4 = psil_shade_prof(:,:,4);
        
        psil_sun_prof1 = psil_sun_prof(:,:,1);
        psil_sun_prof2 = psil_sun_prof(:,:,2);
        psil_sun_prof3 = psil_sun_prof(:,:,3);
        psil_sun_prof4 = psil_sun_prof(:,:,4);
    end
% 
 
    TSCP_variable = cat(3,...
          	An_canopy_norm_prof         , An_canopy_prof            , ...
            An_shade_norm_prof1         , An_shade_norm_prof2       , An_shade_norm_prof3       , An_shade_norm_prof4      , ...
            An_shade_prof               , ...
            An_sun_norm_prof1           , An_sun_norm_prof2         , An_sun_norm_prof3         , An_sun_norm_prof4        , ...    
            An_sun_prof                 ,...
            CAz_prof                    , Ch2o_canopy_prof          , Ci_canopy_prof            , ...
            Ci_shade_prof1              , Ci_shade_prof2            , Ci_shade_prof3            , Ci_shade_prof4           , ...
            Ci_sun_prof1                , Ci_sun_prof2              , Ci_sun_prof3              , Ci_sun_prof4             , ... 
            EAz_prof                    ,...
            Evap_canopy_prof            , H_canopy_norm_prof        , H_canopy_prof             , ...
            H_shade_norm_prof1          , H_shade_norm_prof2        , H_shade_norm_prof3        , H_shade_norm_prof4       , ... 
            H_shade_prof                , ...
            H_sun_norm_prof1            , H_sun_norm_prof2          , H_sun_norm_prof3          , H_sun_norm_prof4         , ...
            H_sun_prof                  , LAI_shade_prof            , LAI_sun_prof              , ...
            LE_canopy_norm_prof         , LE_canopy_prof            , ...
            LE_shade_norm_prof1         , LE_shade_norm_prof2       , LE_shade_norm_prof3       , LE_shade_norm_prof4      , ...
            LE_shade_prof               , ...
            LE_sun_norm_prof1           , LE_sun_norm_prof2         , LE_sun_norm_prof3         , LE_sun_norm_prof4        , ...
            LE_sun_prof                 ,...
            LWabs_can_prof              , LWemit_can_prof           , NIRabs_canopy_norm_prof   , ...
            NIRabs_canopy_prof          , NIRabs_sun_norm_prof      , NIRabs_sun_prof           , ...
            PARabs_canopy_norm_prof     , PARabs_shade_norm_prof    , PARabs_sun_norm_prof      , ...
            PARabs_sun_prof             , Rnrad_canopy_norm_prof    , Rnrad_canopy_prof         , ...
            Rnrad_shade_norm_prof       , Rnrad_shade_prof          , Rnrad_sun_norm_prof       , ...
            Rnrad_sun_prof              , Sh2o_canopy_prof          , TAz_prof                  , ...
            Tl_canopy_prof              , ...
            Tl_shade_Ta_Diff1           , Tl_shade_Ta_Diff2         , Tl_shade_Ta_Diff3         , Tl_shade_Ta_Diff4        , ... 
            Tl_shade_prof1              , Tl_shade_prof2            , Tl_shade_prof3            , Tl_shade_prof4           , ...
            Tl_sun_Ta_Diff1             , Tl_sun_Ta_Diff2           , Tl_sun_Ta_Diff3           , Tl_sun_Ta_Diff4          , ... 
            Tl_sun_prof1                , Tl_sun_prof2              , Tl_sun_prof3              , Tl_sun_prof4             , ... 
            Uz_prof                     , ...
            dryfrac_prof                , fshade_prof               , fsun_prof                 , ...
            gbh_canopy_prof             , ...
            gbh_shade_prof1             , gbh_shade_prof2           , gbh_shade_prof3           , gbh_shade_prof4          , ...
            gbh_sun_prof1               , gbh_sun_prof2             , gbh_sun_prof3             , gbh_sun_prof4            , ...
            gbv_canopy_prof             , ...
            gbv_shade_prof1             , gbv_shade_prof2           , gbv_shade_prof3           , gbv_shade_prof4          , ...
            gbv_sun_prof1               , gbv_sun_prof2             , gbv_sun_prof3             , gbv_sun_prof4            , ...
            gsv_canopy_prof             , ...
            gsv_shade_prof1             , gsv_shade_prof2           , gsv_shade_prof3           , gsv_shade_prof4          , ... 
            gsv_sun_prof1               , gsv_sun_prof2             , gsv_sun_prof3             , gsv_sun_prof4            , ...
            psil_canopy_prof            , ... 
            psil_shade_prof1         	, psil_shade_prof2          , psil_shade_prof3          , psil_shade_prof4         , ...
            psil_sun_prof1              , psil_sun_prof2            , psil_sun_prof3            , psil_sun_prof4);

	setappdata(0,'TSCP_variable',TSCP_variable); 
    setappdata(0,'timevect',timevect);
    setappdata(0,'zhc',zhc);
    setappdata(0,'hcan',PARAMS.CanStruc.hcan);

 
%     DACP_variable = cat(3,...
%           	An_canopy_diurnal_prof     ,  An_shade_diurnal_prof    ,  An_sun_diurnal_prof      ,...
%          	CAz_diurnal_prof           ,  Ch2o_canopy_diurnal_prof ,  Ci_canopy_diurnal_prof   ,...
%             Ci_shade_diurnal_prof      ,  Ci_sun_diurnal_prof      ,  EAz_diurnal_prof         ,...
%             H_canopy_diurnal_prof      ,  H_shade_diurnal_prof     ,  H_sun_diurnal_prof        ,...
%             LE_canopy_diurnal_prof     ,  LE_shade_diurnal_prof    ,  LE_sun_diurnal_prof      ,...
%             LWabs_can_diurnal_prof     ,  LWemit_can_diurnal_prof  ,  NIRabs_canopy_diurnal_prof ,...
%             NIRabs_shade_diurnal_prof  ,  NIRabs_sun_diurnal_prof  ,  PARabs_canopy_diurnal_prof ,...
%             PARabs_shade_diurnal_prof  ,  PARabs_sun_diurnal_prof  ,  Rnrad_canopy_diurnal_prof ,...
%             Rnrad_shade_diurnal_prof   ,  Rnrad_sun_diurnal_prof   ,  Sh2o_canopy_diurnal_prof ,...
%             TAz_diurnal_prof           ,  Tl_canopy_diurnal_prof   ,  Tl_shade_diurnal_prof    ,...
%             Tl_sun_diurnal_prof        ,  TlmTa_canopy_diurnal_prof,  TlmTa_shade_diurnal_prof ,...
%             TlmTa_sun_diurnal_prof     ,  Uz_diurnal_prof          ,  dryfrac_diurnal_prof     ,...
%             fshade_diurnal_prof        ,  fsun_diurnal_prof        ,  gbv_canopy_diurnal_prof  ,...
%             gbv_shade_diurnal_prof     ,  gbv_sun_diurnal_prof     ,  gsv_canopy_diurnal_prof  ,...
%             gsv_shade_diurnal_prof     ,  gsv_sun_diurnal_prof     ,  wetfrac_diurnal_prof  	);
%     
%     setappdata(0,'DACP_variable',DACP_variable); 
    DACP_variable = cat(3,...
        An_canopy_diurnal_prof     ,  An_shade_diurnal_prof    ,  An_sun_diurnal_prof      ,...
        CAz_diurnal_prof           ,  Ch2o_canopy_diurnal_prof ,  Ci_canopy_diurnal_prof   ,...
        Ci_shade_diurnal_prof1     ,  Ci_shade_diurnal_prof2   , Ci_shade_diurnal_prof3    , Ci_shade_diurnal_prof4    ,...  
        Ci_sun_diurnal_prof1       ,  Ci_sun_diurnal_prof2     , Ci_sun_diurnal_prof3      , Ci_sun_diurnal_prof4      ,...  
        EAz_diurnal_prof         ,...
        H_canopy_diurnal_prof      ,  H_shade_diurnal_prof     ,  H_sun_diurnal_prof        ,...
        LE_canopy_diurnal_prof     ,  LE_shade_diurnal_prof    ,  LE_sun_diurnal_prof      ,...
        LWabs_can_diurnal_prof     ,  LWemit_can_diurnal_prof  ,  NIRabs_canopy_diurnal_prof ,...
        NIRabs_shade_diurnal_prof  ,  NIRabs_sun_diurnal_prof  ,  PARabs_canopy_diurnal_prof ,...
        PARabs_shade_diurnal_prof  ,  PARabs_sun_diurnal_prof  ,  Rnrad_canopy_diurnal_prof ,...
        Rnrad_shade_diurnal_prof   ,  Rnrad_sun_diurnal_prof   ,  Sh2o_canopy_diurnal_prof ,...
        TAz_diurnal_prof           ,  Tl_canopy_diurnal_prof   ,  ...
        Tl_shade_diurnal_prof1     ,  Tl_shade_diurnal_prof2   ,  Tl_shade_diurnal_prof3   , Tl_shade_diurnal_prof4    ,...
        Tl_sun_diurnal_prof1       ,  Tl_sun_diurnal_prof2     ,  Tl_sun_diurnal_prof3     , Tl_sun_diurnal_prof4      ,...  
        TlmTa_canopy_diurnal_prof  ,  ...
        TlmTa_shade_diurnal_prof1  ,  TlmTa_shade_diurnal_prof2,  TlmTa_shade_diurnal_prof3, TlmTa_shade_diurnal_prof4 ,...
        TlmTa_sun_diurnal_prof1    ,  TlmTa_sun_diurnal_prof2  ,  TlmTa_sun_diurnal_prof3  , TlmTa_sun_diurnal_prof4   ,...
        Uz_diurnal_prof            ,  dryfrac_diurnal_prof     ,...
        fshade_diurnal_prof        ,  fsun_diurnal_prof        ,  gbv_canopy_diurnal_prof  ,...
        gbv_shade_diurnal_prof1    ,  gbv_shade_diurnal_prof2  ,  gbv_shade_diurnal_prof3  , gbv_shade_diurnal_prof4   ,...  
        gbv_sun_diurnal_prof1      ,  gbv_sun_diurnal_prof2    ,  gbv_sun_diurnal_prof3    , gbv_sun_diurnal_prof4     ,...  
        gsv_canopy_diurnal_prof    ,...
        gsv_shade_diurnal_prof1    ,  gsv_shade_diurnal_prof2  , gsv_shade_diurnal_prof3   , gsv_shade_diurnal_prof4   ,...  
        gsv_sun_diurnal_prof1      ,  gsv_sun_diurnal_prof2    , gsv_sun_diurnal_prof3     , gsv_sun_diurnal_prof4     ,...  
        wetfrac_diurnal_prof  	);

    setappdata(0,'DACP_variable',DACP_variable);

        
    % Show time and information 
    [day_s,month_s] = doy2date(year(1),floor(doy(1)+1));
    [day_e,month_e] = doy2date(year(end),floor(doy(end)));
    hour_s          = floor(hour(1));
    hour_e          = floor(hour(end));
    min_s           = (hour(1)-hour_s)*60;
    min_e           = (hour(end)-hour_e)*60;
    timestep_dec    = decdoy(2) - decdoy(1);
    day_timestep    = round(timestep_dec);
    hour_timestep   = round((timestep_dec-day_timestep)*24);
    min_timestep    = round((timestep_dec*24 - hour_timestep)*60);
    
    start_str = [num2str(month_s), ' - ', num2str(day_s), ' - ',num2str(year(1)), '  |  ',...
                 num2str(hour_s), ':'  ,num2str(min_s)];

    end_str = [num2str(month_e), ' - ', num2str(day_e), ' - ',num2str(year(end)), '  |  ',...
                 num2str(hour_e), ':'  ,num2str(min_e)];
                      
    set(handles.resu_txt_starttime,'String',start_str);
    set(handles.resu_txt_endtime,'String',end_str);
    set(handles.resu_txt_day,'String',num2str(day_timestep));
    set(handles.resu_txt_hour,'String',num2str(hour_timestep));
    set(handles.resu_txt_min,'String',num2str(min_timestep));
    
%     %Show information in Time Series Fluxes
%     TSF_str = {...
%             'An can store'      , 'Ch2o canopy'     , 'Ci mean'         , 'E soil store'    ,   ...
%             'Evap canopy'       , 'Fc eco store'    , 'Fc soil store'   , 'G store'         ,   ...
%             'H can store'       , 'H eco store'     , 'H soil store'    , 'LAI in'          ,   ...
%             'LE can store'      , 'LE eco store'    , 'LE soil store'   , 'LWout store'     ,   ...
%             'PPT in'            , 'Pa in'           , 'RH soil store'   , 'Rg in'           ,   ...
%             'Rnrad can store'   , 'Rnrad eco store' , 'Rnrad soil store', 'SWout store'     ,   ...
%             'Sh2o canopy'       , 'TR can store'    , 'Ta in'           , 'Tl mean'         ,   ...
%             'U in'              , 'VPD in'          , 'ZEN in'          ,   ...
%             'ea in'             , 'fdiff store'     , 'fsv mean'        , 'psil mean'       ,   ...
%             'rpp weight store'  , 'smp weight store', 'ustar in'        }';
%     set(handles.resu_lst_TSF,'String',TSF_str);

    TSF_str = {...
            'An can store'      , 'Ch2o canopy'     , 'Ci mean'         , 'E soil store'    ,   ...
            'Evap canopy'       , 'Fc eco store'    , 'Fc soil store'   , 'G store'         ,   ...
            'H can store'       , 'H eco store'     , 'H soil store'    , ...
            'LAI in species 1'  , 'LAI in species 2', 'LAI in species 3', 'LAI in species 4',   ...
            'LE can store'      , 'LE eco store'    , 'LE soil store'   , 'LWout store'     ,   ...
            'PPT in'            , 'Pa in'           , 'RH soil store'   , 'Rg in'           ,   ...
            'Rnrad can store'   , 'Rnrad eco store' , 'Rnrad soil store', 'SWout store'     ,   ...
            'Sh2o canopy'       , 'TR can store'    , 'Ta in'           , 'Tl mean'         ,   ...
            'U in'              , 'VPD in'          , 'ZEN in'          ,   ...
            'ea in'             , 'fdiff store'     , 'fsv mean'        , 'psil mean'       ,   ...
            'rpp weight store species 1','rpp weight store species 2','rpp weight store species 3','rpp weight store species 4',... 
            'smp weight store' }';
    set(handles.resu_lst_TSF,'String',TSF_str);

        
%     %Show information in Diurnally Averaged Fluxes
%     DAF_str = {...
%             'An diurnal can'    , 'Ch2o diurnal mod', 'Ci diurnal mod'  , 'Evap diurnal mod',   ...
%             'Fc diurnal eco'    , 'Fc diurnal soil' , 'G diurnal mod'   , 'H diurnal can'   ,   ...
%             'H diurnal eco'     , 'H diurnal soil'  , 'LE diurnal can'  , 'LE diurnal eco'  ,   ...
%             'LE diurnal soil'   , 'Rn diurnal can'  , 'Rn diurnal eco'  , 'Rn diurnal soil' ,   ...
%             'Sh2o diurnal mod'  , 'Tl diurnal mod'  , 'psil diurnal mod'}';
% 	set(handles.resu_lst_DAF,'String',DAF_str);

        DAF_str = {...
            'An diurnal can'    , 'Ch2o diurnal mod', 'Ci diurnal mod'  , 'Evap diurnal mod',   ...
            'Fc diurnal eco'    , 'Fc diurnal soil' , 'G diurnal mod'   , 'H diurnal can'   ,   ...
            'H diurnal eco'     , 'H diurnal soil'  , 'LE diurnal can'  , 'LE diurnal eco'  ,   ...
            'LE diurnal soil'   , 'Rn diurnal can'  , 'Rn diurnal eco'  , 'Rn diurnal soil' ,   ...
            'Sh2o diurnal mod'  , 'Tl diurnal mod'  , 'psil diurnal mod'}';
        set(handles.resu_lst_DAF,'String',DAF_str);

%     TSCP_str = {...
%             'An canopy norm prof'       , 'An canopy prof'          , 'An shade norm prof'      ,...
%             'An shade prof'             , 'An sun norm prof'        , 'An sun prof'             ,...
%             'CAz prof'                  , 'Ch2o canopy prof'        , 'Ci canopy prof'          ,...
%             'Ci shade prof'             , 'Ci sun prof'             , 'EAz prof'                ,...
%             'Evap canopy prof'          , 'H canopy norm prof'      , 'H canopy prof'           ,...
%             'H shade norm prof'         , 'H shade prof'            , 'H sun norm prof'         ,...
%             'H sun prof'                , 'LAI shade prof'          , 'LAI sun prof'            ,...
%             'LE canopy norm prof'       , 'LE canopy prof'          , 'LE shade norm prof'      ,...
%             'LE shade prof'             , 'LE sun norm prof'        , 'LE sun prof'             ,...
%             'LWabs can prof'            , 'LWemit can prof'         , 'NIRabs canopy norm prof' ,...
%             'NIRabs canopy prof'        , 'NIRabs sun norm prof'    , 'NIRabs sun prof'         ,...
%             'PARabs canopy norm prof'   , 'PARabs shade norm prof'  , 'PARabs sun norm prof'    ,...
%             'PARabs sun prof'           , 'Rnrad canopy norm prof'  , 'Rnrad canopy prof'       ,...
%             'Rnrad shade norm prof'     , 'Rnrad shade prof'        , 'Rnrad sun norm prof'     ,...
%             'Rnrad sun prof'            , 'Sh2o canopy prof'        , 'TAz prof'                ,...
%             'Tl canopy prof'            , 'Tl shade Ta Diff'        , 'Tl shade prof'           ,...
%             'Tl sun Ta Diff'            , 'Tl sun prof'             , 'Uz prof'              	,...
%             'dryfrac prof'              , 'fshade prof'             , 'fsun prof'               ,...
%             'fsv canopy prof'           , 'fsv shade prof'          , 'fsv sun prof'            ,...
%             'gbh canopy prof'           , 'gbh shade prof'          , 'gbh sun prof'            ,...
%             'gbv canopy prof'           , 'gbv shade prof'          , 'gbv sun prof'            ,...
%             'gsv canopy prof'           , 'gsv shade prof'          , 'gsv sun prof'            ,...
%             'psil canopy prof'          , 'psil shade prof'       	, 'psil sun prof'           }';
% 	set(handles.resu_lst_TSCP,'String',TSCP_str);

    TSCP_str = {...
            'An canopy norm prof'       , 'An canopy prof'          ,...
            'An shade norm prof species 1','An shade norm prof species 2','An shade norm prof species 3','An shade norm prof species 4',...
            'An shade prof'             ,...
            'An sun norm prof species 1','An sun norm prof species 2''An sun norm prof species 3','An sun norm prof species 4'         ,...
            'An sun prof'               ,...
            'CAz prof'                  , 'Ch2o canopy prof'        , 'Ci canopy prof'          ,...
            'Ci shade prof species 1'   , 'Ci shade prof species 2' , 'Ci shade prof species 3' , 'Ci shade prof species 4'            ,...
            'Ci sun prof species 1'     , 'Ci sun prof species 2'   , 'Ci sun prof species 3'   , 'Ci sun prof species 4'              ,...
            'EAz prof'                  ,...
            'Evap canopy prof'          , 'H canopy norm prof'      , 'H canopy prof'           ,...
            'H shade norm prof species 1','H shade norm prof species 2','H shade norm prof species 3','H shade norm prof species 4'    ,...
            'H shade prof'              ,...
            'H sun norm prof species 1' ,'H sun norm prof species 2','H sun norm prof species 3','H sun norm prof species 4'           ,...
            'H sun prof'                , 'LAI shade prof'          , 'LAI sun prof'            ,...
            'LE canopy norm prof'       , 'LE canopy prof'          ,...
            'LE shade norm prof species 1','LE shade norm prof species 2','LE shade norm prof species 3','LE shade norm prof species 4',...
            'LE shade prof'             ,...
            'LE sun norm prof species 1','LE sun norm prof species 2','LE sun norm prof species 3','LE sun norm prof species 4'        ,...
            'LE sun prof'               ,...
            'LWabs can prof'            , 'LWemit can prof'         , 'NIRabs canopy norm prof' ,...
            'NIRabs canopy prof'        , 'NIRabs sun norm prof'    , 'NIRabs sun prof'         ,...
            'PARabs canopy norm prof'   , 'PARabs shade norm prof'  , 'PARabs sun norm prof'    ,...
            'PARabs sun prof'           , 'Rnrad canopy norm prof'  , 'Rnrad canopy prof'       ,...
            'Rnrad shade norm prof'     , 'Rnrad shade prof'        , 'Rnrad sun norm prof'     ,...
            'Rnrad sun prof'            , 'Sh2o canopy prof'        , 'TAz prof'                ,...
            'Tl canopy prof'            ,...
            'Tl shade Ta Diff species 1','Tl shade Ta Diff species 2','Tl shade Ta Diff species 3','Tl shade Ta Diff species 4'        ,...
            'Tl shade prof species 1'   , 'Tl shade prof species 2' , 'Tl shade prof species 3' , 'Tl shade prof species 4'            ,...
            'Tl sun Ta Diff species 1'  , 'Tl sun Ta Diff species 2', 'Tl sun Ta Diff species 3', 'Tl sun Ta Diff species 4'           ,...
            'Tl sun prof species 1'     , 'Tl sun prof species 2'   , 'Tl sun prof species 3'   , 'Tl sun prof species 4'              ,...
            'Uz prof'              	    ,...
            'dryfrac prof'              , 'fshade prof'             , 'fsun prof'               ,...
            'gbh canopy prof'           ,...
            'gbh shade prof species 1'  , 'gbh shade prof species 2', 'gbh shade prof species 3', 'gbh shade prof species 4'           ,...
            'gbh sun prof species 1'    , 'gbh sun prof species 2'  , 'gbh sun prof species 3'  , 'gbh sun prof species 4'             ,...
            'gbv canopy prof'           ,...
            'gbv shade prof species 1'  , 'gbv shade prof species 2', 'gbv shade prof species 3', 'gbv shade prof species 4'           ,...
            'gbv sun prof species 1'    , 'gbv sun prof species 2'  , 'gbv sun prof species 3'  , 'gbv sun prof species 4'             ,...
            'gsv canopy prof'           ,...
            'gsv shade prof species 1'  , 'gsv shade prof species 2', 'gsv shade prof species 3', 'gsv shade prof species 4'           ,... 
            'gsv sun prof species 1'    , 'gsv sun prof species 2'  , 'gsv sun prof species 3'  , 'gsv sun prof species 4'             ,...
            'psil canopy prof'          ,...
            'psil shade prof species 1' ,'psil shade prof species 2','psil shade prof species 3','psil shade prof species 4'           ,...
            'psil sun prof species 1'   , 'psil sun prof species 2' , 'psil sun prof species 3' , 'psil sun prof species 4'            }';
	set(handles.resu_lst_TSCP,'String',TSCP_str);


%     DACP_str = {...
%             'An canopy diurnal prof'    , 'An shade diurnal prof'   , 'An sun diurnal prof'     ,...
%             'CAz diurnal prof'          , 'Ch2o canopy diurnal prof', 'Ci canopy diurnal prof'  ,...
%             'Ci shade diurnal prof'     , 'Ci sun diurnal prof'     , 'EAz diurnal prof'        ,...
%             'H canopy diurnal prof'     , 'H shade diurnal prof'    , 'H sun diurnal prof'      ,...
%             'LE canopy diurnal prof'    , 'LE shade diurnal prof'   , 'LE sun diurnal prof'     ,...
%             'LWabs can diurnal prof'    , 'LWemit can diurnal prof' , 'NIRabs canopy diurnal prof',...
%             'NIRabs shade diurnal prof' , 'NIRabs sun diurnal prof' , 'PARabs canopy diurnal prof',...
%             'PARabs shade diurnal prof' , 'PARabs sun diurnal prof' , 'Rnrad canopy diurnal prof',...
%             'Rnrad shade diurnal prof'  , 'Rnrad sun diurnal prof'  , 'Sh2o canopy diurnal prof',...
%             'TAz diurnal prof'          , 'Tl canopy diurnal prof'  , 'Tl shade diurnal prof'   ,...
%             'Tl sun diurnal prof'       , 'TlmTa canopy diurnal prof','TlmTa shade diurnal prof',...
%             'TlmTa sun diurnal prof'    , 'Uz diurnal prof'         , 'dryfrac diurnal prof'    ,...
%             'fshade diurnal prof'       , 'fsun diurnal prof'       , 'gbv canopy diurnal prof' ,...
%             'gbv shade diurnal prof'    , 'gbv sun diurnal prof'    , 'gsv canopy diurnal prof' ,...
%             'gsv shade diurnal prof'    , 'gsv sun diurnal prof'    , 'wetfrac diurnal prof' 	};
% 	set(handles.resu_lst_DACP,'String',DACP_str);
    DACP_variable = cat(3,...
        An_canopy_diurnal_prof     ,  An_shade_diurnal_prof    ,  An_sun_diurnal_prof      ,...
        CAz_diurnal_prof           ,  Ch2o_canopy_diurnal_prof ,  Ci_canopy_diurnal_prof   ,...
        Ci_shade_diurnal_prof1     ,  Ci_shade_diurnal_prof2   , Ci_shade_diurnal_prof3    , Ci_shade_diurnal_prof4    ,...  
        Ci_sun_diurnal_prof1       ,  Ci_sun_diurnal_prof2     , Ci_sun_diurnal_prof3      , Ci_sun_diurnal_prof4      ,...  
        EAz_diurnal_prof         ,...
        H_canopy_diurnal_prof      ,  H_shade_diurnal_prof     ,  H_sun_diurnal_prof        ,...
        LE_canopy_diurnal_prof     ,  LE_shade_diurnal_prof    ,  LE_sun_diurnal_prof      ,...
        LWabs_can_diurnal_prof     ,  LWemit_can_diurnal_prof  ,  NIRabs_canopy_diurnal_prof ,...
        NIRabs_shade_diurnal_prof  ,  NIRabs_sun_diurnal_prof  ,  PARabs_canopy_diurnal_prof ,...
        PARabs_shade_diurnal_prof  ,  PARabs_sun_diurnal_prof  ,  Rnrad_canopy_diurnal_prof ,...
        Rnrad_shade_diurnal_prof   ,  Rnrad_sun_diurnal_prof   ,  Sh2o_canopy_diurnal_prof ,...
        TAz_diurnal_prof           ,  Tl_canopy_diurnal_prof   ,  ...
        Tl_shade_diurnal_prof1     ,  Tl_shade_diurnal_prof2   ,  Tl_shade_diurnal_prof3   , Tl_shade_diurnal_prof4    ,...
        Tl_sun_diurnal_prof1       ,  Tl_sun_diurnal_prof2     ,  Tl_sun_diurnal_prof3     , Tl_sun_diurnal_prof4      ,...  
        TlmTa_canopy_diurnal_prof  ,  ...
        TlmTa_shade_diurnal_prof1  ,  TlmTa_shade_diurnal_prof2,  TlmTa_shade_diurnal_prof3, TlmTa_shade_diurnal_prof4 ,...
        TlmTa_sun_diurnal_prof1    ,  TlmTa_sun_diurnal_prof2  ,  TlmTa_sun_diurnal_prof3  , TlmTa_sun_diurnal_prof4   ,...
        Uz_diurnal_prof            ,  dryfrac_diurnal_prof     ,...
        fshade_diurnal_prof        ,  fsun_diurnal_prof        ,  gbv_canopy_diurnal_prof  ,...
        gbv_shade_diurnal_prof1    ,  gbv_shade_diurnal_prof2  ,  gbv_shade_diurnal_prof3  , gbv_shade_diurnal_prof4   ,...  
        gbv_sun_diurnal_prof1      ,  gbv_sun_diurnal_prof2    ,  gbv_sun_diurnal_prof3    , gbv_sun_diurnal_prof4     ,...  
        gsv_canopy_diurnal_prof    ,...
        gsv_shade_diurnal_prof1    ,  gsv_shade_diurnal_prof2  , gsv_shade_diurnal_prof3   , gsv_shade_diurnal_prof4   ,...  
        gsv_sun_diurnal_prof1      ,  gsv_sun_diurnal_prof2    , gsv_sun_diurnal_prof3     , gsv_sun_diurnal_prof4     ,...  
        wetfrac_diurnal_prof  	);
    
    DACP_str = {...
            'An canopy diurnal prof'    , 'An shade diurnal prof'   , 'An sun diurnal prof'     ,...
            'CAz diurnal prof'          , 'Ch2o canopy diurnal prof', 'Ci canopy diurnal prof'  ,...
            'Ci shade diurnal prof species 1','Ci shade diurnal prof species 2','Ci shade diurnal prof species 3','Ci shade diurnal prof species 4',...
            'Ci sun diurnal prof species 1','Ci sun diurnal prof species 2','Ci sun diurnal prof species 3','Ci sun diurnal prof species 4'        ,...
            'EAz diurnal prof'          ,...
            'H canopy diurnal prof'     , 'H shade diurnal prof'    , 'H sun diurnal prof'      ,...
            'LE canopy diurnal prof'    , 'LE shade diurnal prof'   , 'LE sun diurnal prof'     ,...
            'LWabs can diurnal prof'    , 'LWemit can diurnal prof' , 'NIRabs canopy diurnal prof',...
            'NIRabs shade diurnal prof' , 'NIRabs sun diurnal prof' , 'PARabs canopy diurnal prof',...
            'PARabs shade diurnal prof' , 'PARabs sun diurnal prof' , 'Rnrad canopy diurnal prof',...
            'Rnrad shade diurnal prof'  , 'Rnrad sun diurnal prof'  , 'Sh2o canopy diurnal prof',...
            'TAz diurnal prof'          , 'Tl canopy diurnal prof'  ,...
            'Tl shade diurnal prof species 1','Tl shade diurnal prof species 2','Tl shade diurnal prof species 3','Tl shade diurnal prof species 4',...
            'Tl sun diurnal prof species 1','Tl sun diurnal prof species 2','Tl sun diurnal prof species 3','Tl sun diurnal prof species 4'        ,...
            'TlmTa canopy diurnal prof' ,...
            'TlmTa shade diurnal prof species 1','TlmTa shade diurnal prof species 2','TlmTa shade diurnal prof species 3','TlmTa shade diurnal prof species 4',...
            'TlmTa sun diurnal prof species 1','TlmTa sun diurnal prof species 2','TlmTa sun diurnal prof species 3','TlmTa sun diurnal prof species 4'        ,...
            'Uz diurnal prof'           , 'dryfrac diurnal prof'    ,...
            'fshade diurnal prof'       , 'fsun diurnal prof'       , 'gbv canopy diurnal prof' ,...
            'gbv shade diurnal prof species 1','gbv shade diurnal prof species 2','gbv shade diurnal prof species 3','gbv shade diurnal prof species 4'    ,...
            'gbv sun diurnal prof species 1','gbv sun diurnal prof species 2','gbv sun diurnal prof species 3','gbv sun diurnal prof species 4'    ,...
            'gsv canopy diurnal prof'   ,...
            'gsv shade diurnal prof species 1','gsv shade diurnal prof species 2','gsv shade diurnal prof species 3','gsv shade diurnal prof species 4'     ,...
            'gsv sun diurnal prof species 1','gsv sun diurnal prof species 2','gsv sun diurnal prof species 3','gsv sun diurnal prof species 4'    ,...
            'wetfrac diurnal prof' 	};
	set(handles.resu_lst_DACP,'String',DACP_str);

    %%%%%%% Nutrient %%%%%%%%%
            % Load Nutrient        
        set(handles.resu_but_nutrient,'Enable','off');
        if Soil_nutrient == 1
            set(handles.resu_but_nutrient,'Enable','on');
            load (fullpath_result,...
                'Cl_store'            , 'Ch_store'          , 'Cb_store'            , 'Nl_store'            ,   ... % [g/m3/dtime]
                'Amm_store'           , 'Nit_store'         , 'CNl_store'           ,  ...                         % [g/m3/dtime]
                ...
                ...
                'VARIABLES'           , 'VERTSTRUC'         , 'CONSTANTS'           ,  ...
                ...
                ...
                'DECl_store'          , 'DECh_store'        , ...
                'MIN_net_store'       , 'MIN_gross_store'   , 'IMM_net_store'       , 'IMM_gross_store'     ,   ... % [g/m?/d]
                'Nitrif_store'        , 'Denitrif_store'    , 'Total_N20_store'     ,   ... % [g/m?/d]
                'LCH_nit_m2_store'    , 'LCH_amm_m2_store'  , 'UP_nit_all_m2_store' , 'UP_amm_all_m2_store' ,   ... % [g/m?/d]
                'mberrorN_store'      , 'mberrorC_store'    );
            
            % Make every things into dtime scale & g/m2 & Excluding Litter
            % Layer
            dz_m=[VARIABLES.SOIL.litterthickness*1000; VERTSTRUC.dzsmm]./1000;
            dzs_m=dz_m(2:end);
            dtime=CONSTANTS.dtime;
            sim_size=size(Cl_store,2);
            Soil_Depth = cumsum(VERTSTRUC.dzsmm/1000);
            Soil_Depth = Soil_Depth(end);
            setappdata(0,'Soil_Depth',num2str(Soil_Depth));
            zns_m=VERTSTRUC.zns;
            setappdata(0,'Soil_Node',num2str(zns_m));
            setappdata(0,'timevect',timevect);
            setappdata(0,'dzsmm',VERTSTRUC.dzsmm);            

            %
            Cl_dtime=Cl_store.*repmat(dz_m,1,sim_size); % [g/m2/dtime]
            Ch_dtime=Ch_store.*repmat(dz_m,1,sim_size); % [g/m2/dtime]
            Cb_dtime=Cb_store.*repmat(dz_m,1,sim_size); % [g/m2/dtime]
            Nl_dtime=Nl_store.*repmat(dz_m,1,sim_size); % [g/m2/dtime]
            Amm_dtime=Amm_store.*repmat(dz_m,1,sim_size); % [g/m2/dtime]
            Nit_dtime=Nit_store.*repmat(dz_m,1,sim_size); % [g/m2/dtime]
            % Excluding Litter Layer
            Cl_dtime(1,:)=[]; 
            Ch_dtime(1,:)=[];
            Cb_dtime(1,:)=[];
            Nl_dtime(1,:)=[];
            Amm_dtime(1,:)=[];
            Nit_dtime(1,:)=[];
            
            %
            DECl_dtime=DECl_store.*(dtime/86400).*repmat(dz_m,1,sim_size); % [g/m2/dtime]
            DECh_dtime=DECh_store.*(dtime/86400).*repmat(dz_m,1,sim_size); % [g/m2/dtime]
            MIN_net_dtime=MIN_net_store.*(dtime/86400).*repmat(dz_m,1,sim_size); % [g/m2/dtime]
            MIN_gross_dtime=MIN_gross_store.*(dtime/86400).*repmat(dz_m,1,sim_size); % [g/m2/dtime]
            IMM_net_dtime=IMM_net_store.*(dtime/86400).*repmat(dz_m,1,sim_size); % [g/m2/dtime]
            IMM_gross_dtime=IMM_gross_store.*(dtime/86400).*repmat(dz_m,1,sim_size); % [g/m2/dtime]
            % Excluding Litter Layer
            DECl_dtime(1,:)=[];
            DECh_dtime(1,:)=[];
            MIN_net_dtime(1,:)=[];
            MIN_gross_dtime(1,:)=[];
            IMM_net_dtime(1,:)=[];
            IMM_gross_dtime(1,:)=[];
            
            Nitrif_dtime=Nitrif_store.*(dtime/86400).*repmat(dz_m,1,sim_size); % [g/m2/dtime]
            Denitrif_dtime=Denitrif_store.*(dtime/86400).*repmat(dz_m,1,sim_size); % [g/m2/dtime]
            Total_N20_dtime=Total_N20_store.*(dtime/86400).*repmat(dz_m,1,sim_size); % [g/m2/dtime]
            % Excluding Litter Layer
            Nitrif_dtime(1,:)=[];
            Denitrif_dtime(1,:)=[];
            Total_N20_dtime(1,:)=[];
            
            LCH_nit_dtime=LCH_nit_m2_store.*(dtime/86400); % [g/m2/dtime]
            LCH_amm_dtime=LCH_amm_m2_store.*(dtime/86400); % [g/m2/dtime]
            % Excluding Litter Layer
            LCH_nit_dtime(1,:)=[];
            LCH_amm_dtime(1,:)=[];
            
            UP_nit_all_dtime=UP_nit_all_m2_store.*(dtime/86400); % [g/m2/dtime]
            UP_amm_all_dtime=UP_amm_all_m2_store.*(dtime/86400); % [g/m2/dtime]
            for i = 1:size(UP_nit_all_dtime,3)
                if size(UP_nit_all_dtime,2) == 1
                    UP_nit_1_dtime(:,i)=UP_nit_all_dtime(:,1,i);
                    UP_amm_1_dtime(:,i)=UP_amm_all_dtime(:,1,i);
                    UP_nit_2_dtime(:,i)=nan.*ones(size(UP_nit_all_dtime,1),1);
                    UP_amm_2_dtime(:,i)=nan.*ones(size(UP_nit_all_dtime,1),1);
                    UP_nit_3_dtime(:,i)=nan.*ones(size(UP_nit_all_dtime,1),1);
                    UP_amm_3_dtime(:,i)=nan.*ones(size(UP_nit_all_dtime,1),1);
                    UP_nit_4_dtime(:,i)=nan.*ones(size(UP_nit_all_dtime,1),1);
                    UP_amm_4_dtime(:,i)=nan.*ones(size(UP_nit_all_dtime,1),1);
                elseif size(UP_nit_all_dtime,2) == 2
                    UP_nit_1_dtime(:,i)=UP_nit_all_dtime(:,1,i);
                    UP_amm_1_dtime(:,i)=UP_amm_all_dtime(:,1,i);
                    UP_nit_2_dtime(:,i)=UP_nit_all_dtime(:,2,i);
                    UP_amm_2_dtime(:,i)=UP_amm_all_dtime(:,2,i);
                    UP_nit_3_dtime(:,i)=nan.*ones(size(UP_nit_all_dtime,1),1);
                    UP_amm_3_dtime(:,i)=nan.*ones(size(UP_nit_all_dtime,1),1);
                    UP_nit_4_dtime(:,i)=nan.*ones(size(UP_nit_all_dtime,1),1);
                    UP_amm_4_dtime(:,i)=nan.*ones(size(UP_nit_all_dtime,1),1);
                elseif size(UP_nit_all_dtime,2) == 3
                    UP_nit_1_dtime(:,i)=UP_nit_all_dtime(:,1,i);
                    UP_amm_1_dtime(:,i)=UP_amm_all_dtime(:,1,i);
                    UP_nit_2_dtime(:,i)=UP_nit_all_dtime(:,2,i);
                    UP_amm_2_dtime(:,i)=UP_amm_all_dtime(:,2,i);
                    UP_nit_3_dtime(:,i)=UP_nit_all_dtime(:,3,i);
                    UP_amm_3_dtime(:,i)=UP_amm_all_dtime(:,3,i);
                    UP_nit_4_dtime(:,i)=nan.*ones(size(UP_nit_all_dtime,1),1);
                    UP_amm_4_dtime(:,i)=nan.*ones(size(UP_nit_all_dtime,1),1);
                elseif size(UP_nit_all_dtime,2) == 4
                    UP_nit_1_dtime(:,i)=UP_nit_all_dtime(:,1,i);
                    UP_amm_1_dtime(:,i)=UP_amm_all_dtime(:,1,i);
                    UP_nit_2_dtime(:,i)=UP_nit_all_dtime(:,2,i);
                    UP_amm_2_dtime(:,i)=UP_amm_all_dtime(:,2,i);
                    UP_nit_3_dtime(:,i)=UP_nit_all_dtime(:,3,i);
                    UP_amm_3_dtime(:,i)=UP_amm_all_dtime(:,3,i);
                    UP_nit_4_dtime(:,i)=UP_nit_all_dtime(:,4,i);
                    UP_amm_4_dtime(:,i)=UP_amm_all_dtime(:,4,i);
                end
            end
            % Excluding Litter Layer
            UP_nit_1_dtime(1,:)=[];
            UP_amm_1_dtime(1,:)=[];
            UP_nit_2_dtime(1,:)=[];
            UP_amm_2_dtime(1,:)=[];
            UP_nit_3_dtime(1,:)=[];
            UP_amm_3_dtime(1,:)=[];
            UP_nit_4_dtime(1,:)=[];
            UP_amm_4_dtime(1,:)=[];
            
            mberrorN_dtime=mberrorN_store.*(dtime/86400); % [g/m2/dtime]
            mberrorC_dtime=mberrorC_store.*(dtime/86400); % [g/m2/dtime]
            
            % Time Series Fluxes
            TSFN_variable = [...
                sum(Cl_dtime)'      , sum(Ch_dtime)'      , sum(Cb_dtime)'        , sum(Nl_dtime)'       , sum(Amm_dtime)'    , sum(Nit_dtime)', ...
                sum(DECl_dtime)'    , sum(DECh_dtime)'    , sum(MIN_net_dtime)'   , sum(MIN_gross_dtime)', sum(IMM_net_dtime)', sum(IMM_gross_dtime)', ...
                sum(Nitrif_dtime)'  , sum(Denitrif_dtime)', sum(Total_N20_dtime)' , ...
                sum(LCH_nit_dtime)' , sum(LCH_amm_dtime)' , ...
                sum(UP_nit_1_dtime)', sum(UP_amm_1_dtime)', sum(UP_nit_2_dtime)'  , sum(UP_amm_2_dtime)', ...
                sum(UP_nit_3_dtime)', sum(UP_amm_3_dtime)', sum(UP_nit_4_dtime)'  , sum(UP_amm_4_dtime)', ...
                mberrorC_dtime'     , mberrorN_dtime', ...
                ];
            setappdata(0,'TSFN_variable',TSFN_variable);
            
            %Show information in Time Series Fluxes
            TSFN_str = {...
                'Soil Litter Carbon [gC/m2/dtime]', ...
                'Soil Humus Carbon [gC/m2/dtime]', ...
                'Soil Microbial Carbon [gC/m2/dtime]', ...
                'Soil Litter Nitrogen [gN/m2/dtime]',   ...
                'Soil Ammonium [gN/m2/dtime]', ...
                'Soil Nitrate [gN/m2/dtime]', ...
                'Litter Decomposition [gN/m2/dtime]', ...
                'Humus Decomposition [gN/m2/dtime]', ...
                'Net Mineralization [gN/m2/dtime]', ...
                'Gross Mineralization [gN/m2/dtime]', ...
                'Net Immobilization [gN/m2/dtime]',...
                'Gross Immobilization [gN/m2/dtime]',...
                'Nitrification [gN/m2/dtime]', ...
                'Denitrification [gN/m2/dtime]', ...
                'N2O Flux [gN/m2/dtime]', ...
                'Nitrate Leaching (out of system) [gN/m2/dtime]', ...
                'Ammonium Leaching (out of system) [gN/m2/dtime]', ...
                'Nitrate Uptaken by Species 1 [gN/m2/dtime]', ...
                'Ammonium Uptaken by Species 1 [gN/m2/dtime]', ...
                'Nitrate Uptaken by Species 2 [gN/m2/dtime]', ...
                'Ammonium Uptaken by Species 2 [gN/m2/dtime]', ...
                'Nitrate Uptaken by Species 3 [gN/m2/dtime]', ...
                'Ammonium Uptaken by Species 3 [gN/m2/dtime]', ...
                'Nitrate Uptaken bu Species 4 [gN/m2/dtime]', ...
                'Ammonium Uptaken by Species 4 [gN/m2/dtime]', ...
                'Carbon Mass Balance [gN/m2/dtime]', ...
                'Nitrogen Mass Balance [gN/m2/dtime]', ...
                }';
            set(handles.resu_lst_TSFN,'String',TSFN_str);
            
            % Time Series Soil Profile
            TSSP_variable = cat(3,...
                Cl_dtime./repmat(dzs_m,1,size(Cl_dtime,2))      , Ch_dtime./repmat(dzs_m,1,size(Cl_dtime,2))      , Cb_dtime./repmat(dzs_m,1,size(Cl_dtime,2))        , Nl_dtime./repmat(dzs_m,1,size(Cl_dtime,2))       , Amm_dtime./repmat(dzs_m,1,size(Cl_dtime,2))    , Nit_dtime./repmat(dzs_m,1,size(Cl_dtime,2)), ...
                DECl_dtime./repmat(dzs_m,1,size(Cl_dtime,2))    , DECh_dtime./repmat(dzs_m,1,size(Cl_dtime,2))    , MIN_net_dtime./repmat(dzs_m,1,size(Cl_dtime,2))   , MIN_gross_dtime./repmat(dzs_m,1,size(Cl_dtime,2)), IMM_net_dtime./repmat(dzs_m,1,size(Cl_dtime,2)), IMM_gross_dtime./repmat(dzs_m,1,size(Cl_dtime,2)), ...
                Nitrif_dtime./repmat(dzs_m,1,size(Cl_dtime,2))  , Denitrif_dtime./repmat(dzs_m,1,size(Cl_dtime,2)), Total_N20_dtime./repmat(dzs_m,1,size(Cl_dtime,2)) , ...
                LCH_nit_dtime./repmat(dzs_m,1,size(Cl_dtime,2)) , LCH_amm_dtime./repmat(dzs_m,1,size(Cl_dtime,2)) , ...
                UP_nit_1_dtime./repmat(dzs_m,1,size(Cl_dtime,2)), UP_amm_1_dtime./repmat(dzs_m,1,size(Cl_dtime,2)), UP_nit_2_dtime./repmat(dzs_m,1,size(Cl_dtime,2))  , UP_amm_2_dtime./repmat(dzs_m,1,size(Cl_dtime,2)), ...
                UP_nit_3_dtime./repmat(dzs_m,1,size(Cl_dtime,2)), UP_amm_3_dtime./repmat(dzs_m,1,size(Cl_dtime,2)), UP_nit_4_dtime./repmat(dzs_m,1,size(Cl_dtime,2))  , UP_amm_4_dtime./repmat(dzs_m,1,size(Cl_dtime,2)) ...
                );
            setappdata(0,'TSSP_variable',TSSP_variable);
            
            %Show information in Time Series Soil Profile
            TSSP_str = {...
                'Soil Litter Carbon [gC/m3/dtime]', ...
                'Soil Humus Carbon [gC/m3/dtime]', ...
                'Soil Microbial Carbon [gC/m3/dtime]', ...
                'Soil Litter Nitrogen [gN/m3/dtime]',   ...
                'Soil Ammonium [gN/m3/dtime]', ...
                'Soil Nitrate [gN/m3/dtime]', ...
                'Litter Decomposition [gN/m3/dtime]', ...
                'Humus Decomposition [gN/m3/dtime]', ...
                'Net Mineralization [gN/m3/dtime]', ...
                'Gross Mineralization [gN/m3/dtime]', ...
                'Net Immobilization [gN/m3/dtime]',...
                'Gross Immobilization [gN/m3/dtime]',...
                'Nitrification [gN/m3/dtime]', ...
                'Denitrification [gN/m3/dtime]', ...
                'N2O Flux [gN/m3/dtime]', ...
                'Nitrate Leaching [gN/m3/dtime]', ...
                'Ammonium Leaching [gN/m3/dtime]', ...
                'Nitrate Uptaken by Species 1 [gN/m3/dtime]', ...
                'Ammonium Uptaken by Species 1 [gN/m3/dtime]', ...
                'Nitrate Uptaken by Species 2 [gN/m3/dtime]', ...
                'Ammonium Uptaken by Species 2 [gN/m3/dtime]', ...
                'Nitrate Uptaken by Species 3 [gN/m3/dtime]', ...
                'Ammonium Uptaken by Species 3 [gN/m3/dtime]', ...
                'Nitrate Uptaken bu Species 4 [gN/m3/dtime]', ...
                'Ammonium Uptaken by Species 4 [gN/m3/dtime]', ...
                }';
            set(handles.resu_lst_TSSP,'String',TSSP_str); 
            
            % Diurnally Averaged Fluxes
            hr = unique(hour);
            setappdata(0,'hr',hr);

            % Code Library Paths
%             addpath('./LOCAL_CODES/');
%             addpath('./LOCAL_CODES/CANOPY/');
%             addpath('./LOCAL_CODES/ROOT_SOIL/');
%             addpath('./LOCAL_CODES/ROOT_SOIL/IMPLICIT');
%             addpath('./LOCAL_CODES/ROOT_SOIL/CN_MODEL');
            addpath('./LOCAL_CODES/NUMERICAL/OTHERS');
%            addpath('./LOCAL_CODES/PLOTTING/');


            [Cl_diurnal, Cl_std]               = DIURNAL_AVERAGE (hr, hour, sum(Cl_dtime));
            [Ch_diurnal, Ch_std]               = DIURNAL_AVERAGE (hr, hour, sum(Ch_dtime));
            [Cb_diurnal, Cb_std]               = DIURNAL_AVERAGE (hr, hour, sum(Cb_dtime));
            [Nl_diurnal, Nl_std]               = DIURNAL_AVERAGE (hr, hour, sum(Nl_dtime));
            [Amm_diurnal, Amm_std]             = DIURNAL_AVERAGE (hr, hour, sum(Amm_dtime));
            [Nit_diurnal, Nit_std]             = DIURNAL_AVERAGE (hr, hour, sum(Nit_dtime));
            
            [DECl_diurnal, DECl_std]           = DIURNAL_AVERAGE (hr, hour, sum(DECl_dtime));
            [DECh_diurnal, DECh_std]           = DIURNAL_AVERAGE (hr, hour, sum(DECh_dtime));
            [MIN_net_diurnal, MIN_net_std]     = DIURNAL_AVERAGE (hr, hour, sum(MIN_net_dtime));
            [MIN_gross_diurnal, MIN_gross_std] = DIURNAL_AVERAGE (hr, hour, sum(MIN_gross_dtime));
            [IMM_net_diurnal, IMM_net_std]     = DIURNAL_AVERAGE (hr, hour, sum(IMM_net_dtime));
            [IMM_gross_diurnal, IMM_gross_std] = DIURNAL_AVERAGE (hr, hour, sum(IMM_gross_dtime));
            
            [Nitrif_diurnal, Nitrif_std]       = DIURNAL_AVERAGE (hr, hour, sum(Nitrif_dtime));
            [Denitrif_diurnal, Denitrif_std]   = DIURNAL_AVERAGE (hr, hour, sum(Denitrif_dtime));
            [Total_N20_diurnal, Total_N20_std] = DIURNAL_AVERAGE (hr, hour, sum(Total_N20_dtime));
            
            [LCH_nit_diurnal, LCH_nit_std]     = DIURNAL_AVERAGE (hr, hour, sum(LCH_nit_dtime));
            [LCH_amm_diurnal, LCH_amm_std]     = DIURNAL_AVERAGE (hr, hour, sum(LCH_amm_dtime));
            
            [UP_nit_1_diurnal, UP_nit_1_std]   = DIURNAL_AVERAGE (hr, hour, sum(UP_nit_1_dtime));
            [UP_amm_1_diurnal, UP_amm_1_std]   = DIURNAL_AVERAGE (hr, hour, sum(UP_amm_1_dtime));
            [UP_nit_2_diurnal, UP_nit_2_std]   = DIURNAL_AVERAGE (hr, hour, sum(UP_nit_2_dtime));
            [UP_amm_2_diurnal, UP_amm_2_std]   = DIURNAL_AVERAGE (hr, hour, sum(UP_amm_2_dtime));
            [UP_nit_3_diurnal, UP_nit_3_std]   = DIURNAL_AVERAGE (hr, hour, sum(UP_nit_3_dtime));
            [UP_amm_3_diurnal, UP_amm_3_std]   = DIURNAL_AVERAGE (hr, hour, sum(UP_amm_3_dtime));
            [UP_nit_4_diurnal, UP_nit_4_std]   = DIURNAL_AVERAGE (hr, hour, sum(UP_nit_4_dtime));
            [UP_amm_4_diurnal, UP_amm_4_std]   = DIURNAL_AVERAGE (hr, hour, sum(UP_amm_4_dtime));
            
            [LCH_nit_4_diurnal, LCH_nit_4_std] = DIURNAL_AVERAGE (hr, hour, sum(LCH_nit_dtime));
            [LCH_amm_4_diurnal, LCH_amm_4_std] = DIURNAL_AVERAGE (hr, hour, sum(LCH_amm_dtime));
            
            DAFN_variable = [...
                Cl_diurnal'       , Cl_std', ...
                Ch_diurnal'       , Ch_std', ...
                Cb_diurnal'       , Cb_std', ...
                Nl_diurnal'       , Nl_std', ...
                Amm_diurnal'      , Amm_std', ...
                Nit_diurnal'      , Nit_std', ...
                DECl_diurnal'     , DECl_std', ...
                DECh_diurnal'     , DECh_std', ...
                MIN_net_diurnal'  , MIN_net_std', ...
                MIN_gross_diurnal', MIN_gross_std', ...
                IMM_net_diurnal'  , IMM_net_std', ...
                IMM_gross_diurnal', IMM_gross_std', ...
                Nitrif_diurnal'   , Nitrif_std', ...
                Denitrif_diurnal' , Denitrif_std', ...
                Total_N20_diurnal', Total_N20_std', ...
                LCH_nit_diurnal'  , LCH_nit_std', ...
                LCH_amm_diurnal'  , LCH_amm_std', ...
                UP_nit_1_diurnal' , UP_nit_1_std', ...
                UP_amm_1_diurnal' , UP_amm_1_std', ...
                UP_nit_2_diurnal' , UP_nit_2_std', ...
                UP_amm_2_diurnal' , UP_amm_2_std', ...
                UP_nit_3_diurnal' , UP_nit_3_std', ...
                UP_amm_3_diurnal' , UP_amm_3_std', ...
                UP_nit_4_diurnal' , UP_nit_4_std', ...
                UP_amm_4_diurnal' , UP_amm_4_std'];
            setappdata(0,'DAFN_variable',DAFN_variable);
            
            %Show information in Diurnally Averaged Flux
            DAFN_str = {...
                'Soil Litter Carbon [gC/m2]', ...
                'Soil Humus Carbon [gC/m2]', ...
                'Soil Microbial Carbon [gC/m2]', ...
                'Soil Litter Nitrogen [gN/m2]',   ...
                'Soil Ammonium [gN/m2]', ...
                'Soil Nitrate [gN/m2]', ...
                'Litter Decomposition [gN/m2]', ...
                'Humus Decomposition [gN/m2]', ...
                'Net Mineralization [gN/m2]', ...
                'Gross Mineralization [gN/m2]', ...
                'Net Immobilization [gN/m2]',...
                'Gross Immobilization [gN/m2]',...
                'Nitrification [gN/m2]', ...
                'Denitrification [gN/m2]', ...
                'N2O Flux [gN/m2]', ...
                'Nitrate Leaching [gN/m2]', ...
                'Ammonium Leaching [gN/m2]', ...
                'Nitrate Uptaken by Species 1 [gN/m2]', ...
                'Ammonium Uptaken by Species 1 [gN/m2]', ...
                'Nitrate Uptaken by Species 2 [gN/m2]', ...
                'Ammonium Uptaken by Species 2 [gN/m2]', ...
                'Nitrate Uptaken by Species 3 [gN/m2]', ...
                'Ammonium Uptaken by Species 3 [gN/m2]', ...
                'Nitrate Uptaken bu Species 4 [gN/m2]', ...
                'Ammonium Uptaken by Species 4 [gN/m2]', ...
                }';
            set(handles.resu_lst_DAFN,'String',DAFN_str);
            
            %Diurnally Averaged Soil Profile
            for i = 1:PARAMS.nl_soil
                [Cl_diurnal_prof(i,:), Cl_std_prof(i,:)]               = DIURNAL_AVERAGE (hr, hour, Cl_dtime(i,:)./repmat(dzs_m(i),1,size(Cl_dtime,2)));
                [Ch_diurnal_prof(i,:), Ch_std_prof(i,:)]               = DIURNAL_AVERAGE (hr, hour, Ch_dtime(i,:)./repmat(dzs_m(i),1,size(Cl_dtime,2)));
                [Cb_diurnal_prof(i,:), Cb_std_prof(i,:)]               = DIURNAL_AVERAGE (hr, hour, Cb_dtime(i,:)./repmat(dzs_m(i),1,size(Cl_dtime,2)));
                [Nl_diurnal_prof(i,:), Nl_std_prof(i,:)]               = DIURNAL_AVERAGE (hr, hour, Nl_dtime(i,:)./repmat(dzs_m(i),1,size(Cl_dtime,2)));
                [Amm_diurnal_prof(i,:), Amm_std_prof(i,:)]             = DIURNAL_AVERAGE (hr, hour, Amm_dtime(i,:)./repmat(dzs_m(i),1,size(Cl_dtime,2)));
                [Nit_diurnal_prof(i,:), Nit_std_prof(i,:)]             = DIURNAL_AVERAGE (hr, hour, Nit_dtime(i,:)./repmat(dzs_m(i),1,size(Cl_dtime,2)));
                
                [DECl_diurnal_prof(i,:), DECl_std_prof(i,:)]           = DIURNAL_AVERAGE (hr, hour, DECl_dtime(i,:)./repmat(dzs_m(i),1,size(Cl_dtime,2)));
                [DECh_diurnal_prof(i,:), DECh_std_prof(i,:)]           = DIURNAL_AVERAGE (hr, hour, DECh_dtime(i,:)./repmat(dzs_m(i),1,size(Cl_dtime,2)));
                [MIN_net_diurnal_prof(i,:), MIN_net_std_prof(i,:)]     = DIURNAL_AVERAGE (hr, hour, MIN_net_dtime(i,:)./repmat(dzs_m(i),1,size(Cl_dtime,2)));
                [MIN_gross_diurnal_prof(i,:), MIN_gross_std_prof(i,:)] = DIURNAL_AVERAGE (hr, hour, MIN_gross_dtime(i,:)./repmat(dzs_m(i),1,size(Cl_dtime,2)));
                [IMM_net_diurnal_prof(i,:), IMM_net_std_prof(i,:)]     = DIURNAL_AVERAGE (hr, hour, IMM_net_dtime(i,:)./repmat(dzs_m(i),1,size(Cl_dtime,2)));
                [IMM_gross_diurnal_prof(i,:), IMM_gross_std_prof(i,:)] = DIURNAL_AVERAGE (hr, hour, IMM_gross_dtime(i,:)./repmat(dzs_m(i),1,size(Cl_dtime,2)));
                
                [Nitrif_diurnal_prof(i,:), Nitrif_std_prof(i,:)]       = DIURNAL_AVERAGE (hr, hour, Nitrif_dtime(i,:)./repmat(dzs_m(i),1,size(Cl_dtime,2)));
                [Denitrif_diurnal_prof(i,:), Denitrif_std_prof(i,:)]   = DIURNAL_AVERAGE (hr, hour, Denitrif_dtime(i,:)./repmat(dzs_m(i),1,size(Cl_dtime,2)));
                [Total_N20_diurnal_prof(i,:), Total_N20_std_prof(i,:)] = DIURNAL_AVERAGE (hr, hour, Total_N20_dtime(i,:)./repmat(dzs_m(i),1,size(Cl_dtime,2)));
                
                [LCH_nit_diurnal_prof(i,:), LCH_nit_std_prof(i,:)]     = DIURNAL_AVERAGE (hr, hour, LCH_nit_dtime(i,:)./repmat(dzs_m(i),1,size(Cl_dtime,2)));
                [LCH_amm_diurnal_prof(i,:), LCH_amm_std_prof(i,:)]     = DIURNAL_AVERAGE (hr, hour, LCH_amm_dtime(i,:)./repmat(dzs_m(i),1,size(Cl_dtime,2)));
                
                [UP_nit_1_diurnal_prof(i,:), UP_nit_1_std_prof(i,:)]   = DIURNAL_AVERAGE (hr, hour, UP_nit_1_dtime(i,:)./repmat(dzs_m(i),1,size(Cl_dtime,2)));
                [UP_amm_1_diurnal_prof(i,:), UP_amm_1_std_prof(i,:)]   = DIURNAL_AVERAGE (hr, hour, UP_amm_1_dtime(i,:)./repmat(dzs_m(i),1,size(Cl_dtime,2)));
                [UP_nit_2_diurnal_prof(i,:), UP_nit_2_std_prof(i,:)]   = DIURNAL_AVERAGE (hr, hour, UP_nit_2_dtime(i,:)./repmat(dzs_m(i),1,size(Cl_dtime,2)));
                [UP_amm_2_diurnal_prof(i,:), UP_amm_2_std_prof(i,:)]   = DIURNAL_AVERAGE (hr, hour, UP_amm_2_dtime(i,:)./repmat(dzs_m(i),1,size(Cl_dtime,2)));
                [UP_nit_3_diurnal_prof(i,:), UP_nit_3_std_prof(i,:)]   = DIURNAL_AVERAGE (hr, hour, UP_nit_3_dtime(i,:)./repmat(dzs_m(i),1,size(Cl_dtime,2)));
                [UP_amm_3_diurnal_prof(i,:), UP_amm_3_std_prof(i,:)]   = DIURNAL_AVERAGE (hr, hour, UP_amm_3_dtime(i,:)./repmat(dzs_m(i),1,size(Cl_dtime,2)));
                [UP_nit_4_diurnal_prof(i,:), UP_nit_4_std_prof(i,:)]   = DIURNAL_AVERAGE (hr, hour, UP_nit_4_dtime(i,:)./repmat(dzs_m(i),1,size(Cl_dtime,2)));
                [UP_amm_4_diurnal_prof(i,:), UP_amm_4_std_prof(i,:)]   = DIURNAL_AVERAGE (hr, hour, UP_amm_4_dtime(i,:)./repmat(dzs_m(i),1,size(Cl_dtime,2)));
                
                [LCH_nit_4_diurnal_prof(i,:), LCH_nit_4_std_prof(i,:)] = DIURNAL_AVERAGE (hr, hour, LCH_nit_dtime(i,:)./repmat(dzs_m(i),1,size(Cl_dtime,2)));
                [LCH_amm_4_diurnal_prof(i,:) LCH_amm_4_std_prof(i,:)] = DIURNAL_AVERAGE (hr, hour, LCH_amm_dtime(i,:)./repmat(dzs_m(i),1,size(Cl_dtime,2)));
            end
            
            DASP_variable = cat(3,...
                Cl_diurnal_prof'      , ...
                Ch_diurnal_prof'       , ...
                Cb_diurnal_prof'       , ...
                Nl_diurnal_prof'       , ...
                Amm_diurnal_prof'      , ...
                Nit_diurnal_prof'      , ...
                DECl_diurnal_prof'     , ...
                DECh_diurnal_prof'     , ...
                MIN_net_diurnal_prof'  , ...
                MIN_gross_diurnal_prof', ...
                IMM_net_diurnal_prof'  , ...
                IMM_gross_diurnal_prof', ...
                Nitrif_diurnal_prof'   , ...
                Denitrif_diurnal_prof' , ...
                Total_N20_diurnal_prof', ...
                LCH_nit_diurnal_prof'  , ...
                LCH_amm_diurnal_prof'  , ...
                UP_nit_1_diurnal_prof' , ...
                UP_amm_1_diurnal_prof' , ...
                UP_nit_2_diurnal_prof' , ...
                UP_amm_2_diurnal_prof' , ...
                UP_nit_3_diurnal_prof' , ...
                UP_amm_3_diurnal_prof' , ...
                UP_nit_4_diurnal_prof' , ...
                UP_amm_4_diurnal_prof' );
            setappdata(0,'DASP_variable',DASP_variable);
            
            
            %Show information in Diurnally Averaged Flux
            DASP_str = {...
                'Soil Litter Carbon [gC/m3]', ...
                'Soil Humus Carbon [gC/m3]', ...
                'Soil Microbial Carbon [gC/m3]', ...
                'Soil Litter Nitrogen [gN/m3]',   ...
                'Soil Ammonium [gN/m3]', ...
                'Soil Nitrate [gN/m3]', ...
                'Litter Decomposition [gN/m3]', ...
                'Humus Decomposition [gN/m3]', ...
                'Net Mineralization [gN/m3]', ...
                'Gross Mineralization [gN/m3]', ...
                'Net Immobilization [gN/m3]',...
                'Gross Immobilization [gN/m3]',...
                'Nitrification [gN/m3]', ...
                'Denitrification [gN/m3]', ...
                'N2O Flux [gN/m3]', ...
                'Nitrate Leaching [gN/m3]', ...
                'Ammonium Leaching [gN/m3]', ...
                'Nitrate Uptaken by Species 1 [gN/m3]', ...
                'Ammonium Uptaken by Species 1 [gN/m3]', ...
                'Nitrate Uptaken by Species 2 [gN/m3]', ...
                'Ammonium Uptaken by Species 2 [gN/m3]', ...
                'Nitrate Uptaken by Species 3 [gN/m3]', ...
                'Ammonium Uptaken by Species 3 [gN/m3]', ...
                'Nitrate Uptaken bu Species 4 [gN/m3]', ...
                'Ammonium Uptaken by Species 4 [gN/m3]', ...
                }';
            set(handles.resu_lst_DASP,'String',DASP_str);
        end

end

function resu_txt_load_Callback(hObject, eventdata, handles)


function resu_txt_load_CreateFcn(hObject, eventdata, handles)

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end


function pushbutton2_Callback(hObject, eventdata, handles)


function resu_but_exit_Callback(hObject, eventdata, handles)

function button_load_picture(hObject, eventdata, handles)
RGB_open=imread('./users/icons/open.png');
set(handles.resu_but_load, 'Cdata', RGB_open);

function resu_but_load_CreateFcn(hObject, eventdata, handles)


function pushbutton4_Callback(hObject, eventdata, handles)
close;

function pushbutton5_Callback(hObject, eventdata, handles)


function checkbox1_Callback(hObject, eventdata, handles)


function resu_but_plot_TSF_Callback(hObject, eventdata, handles)
index_TSF       = get(handles.resu_lst_TSF,'Value');
TSF_str         = get(handles.resu_lst_TSF,'String');
TSF_variable    = getappdata(0,'TSF_variable');
figcount_TSF    = getappdata(0,'figcount_TSF');


TSF_hold        = get(handles.TSF_chk_hold,'Value');
if TSF_hold == 1
    figure(figcount_TSF)
    figcount_TSF = figcount_TSF;
    hold on
else
    figure(figcount_TSF)
    figcount_TSF = figcount_TSF + 1;
    hold off
end

setappdata(0, 'figcount_TSF', figcount_TSF);
plot(TSF_variable(:,index_TSF));
y_lbl_str = TSF_str(index_TSF);
xlabel('Time step');
ylabel(y_lbl_str);

TSF_grid        = get(handles.TSF_chk_grid,'Value');
if TSF_grid == 1
    grid on
else
    grid off
end


function TSF_chk_hold_Callback(hObject, eventdata, handles)


function pushbutton8_Callback(hObject, eventdata, handles)


function checkbox4_Callback(hObject, eventdata, handles)


function pushbutton9_Callback(hObject, eventdata, handles)


function checkbox5_Callback(hObject, eventdata, handles)


function resu_txt_hour_Callback(hObject, eventdata, handles)


function resu_txt_hour_CreateFcn(hObject, eventdata, handles)

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end


function resu_txt_min_Callback(hObject, eventdata, handles)


function resu_txt_min_CreateFcn(hObject, eventdata, handles)

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end


function resu_txt_day_Callback(hObject, eventdata, handles)


function resu_txt_day_CreateFcn(hObject, eventdata, handles)

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end


function resu_txt_endtime_Callback(hObject, eventdata, handles)


function resu_txt_endtime_CreateFcn(hObject, eventdata, handles)

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end


function resu_but_endtime_Callback(hObject, eventdata, handles)


function resu_txt_starttime_Callback(hObject, eventdata, handles)


function resu_txt_starttime_CreateFcn(hObject, eventdata, handles)

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end


function resu_but_starttime_Callback(hObject, eventdata, handles)


function resu_but_plot_DAF_Callback(hObject, eventdata, handles)
index_DAF       = get(handles.resu_lst_DAF,'Value');
DAF_str         = get(handles.resu_lst_DAF,'String');
DAF_variable    = getappdata(0,'DAF_variable');
hr              = getappdata(0,'hr');
figcount_DAF    = getappdata(0,'figcount_DAF');


DAF_hold        = get(handles.DAF_chk_hold,'Value');
if DAF_hold == 1
    figure(figcount_DAF);
    figcount_DAF = figcount_DAF;
    hold on
else
    figure(figcount_DAF);
    figcount_DAF = figcount_DAF + 1;
    hold off
end

setappdata(0, 'figcount_DAF', figcount_DAF);
errorbar(hr, DAF_variable(2*index_DAF-1,:), DAF_variable(2*index_DAF,:), '-ok')
y_lbl_str       = DAF_str(index_DAF);
xlabel('Hour');
ylabel(y_lbl_str);

DAF_grid        = get(handles.DAF_chk_grid,'Value');
if DAF_grid == 1
    grid on
else
    grid off
end


function DAF_chk_hold_Callback(hObject, eventdata, handles)


function resu_but_plot_DACP_Callback(hObject, eventdata, handles)
index_DACP      = get(handles.resu_lst_DACP,'Value');
DACP_str        = get(handles.resu_lst_DACP,'String');
DACP_variable   = getappdata(0,'DACP_variable'); 
hr              = getappdata(0,'hr');
zhc             = getappdata(0,'zhc');
hcan            = getappdata(0,'hcan');
figcount_DACP   = getappdata(0,'figcount_DACP');

figure(figcount_DACP);
figcount_DACP = figcount_DACP + 1;
setappdata(0, 'figcount_DACP', figcount_DACP);

pcolor(hr, zhc/hcan, DACP_variable(:,:,index_DACP))
shading interp
colorbar
tit             = DACP_str(index_DACP);
title(tit, 'FontSize', 12, 'FontWeight', 'b')
ylabel('\bf z / h', 'FontSize', 12)
xlabel('\bf Hour', 'FontSize', 12)

function checkbox10_Callback(hObject, eventdata, handles)


function resu_but_plot_TSCP_Callback(hObject, eventdata, handles)
index_TSCP      = get(handles.resu_lst_TSCP,'Value');
TSCP_str        = get(handles.resu_lst_TSCP,'String');
TSCP_variable   = getappdata(0,'TSCP_variable'); 
timevect        = getappdata(0,'timevect');
zhc             = getappdata(0,'zhc');
hcan            = getappdata(0,'hcan');
figcount_TSCP   = getappdata(0,'figcount_TSCP');

figure(figcount_TSCP);
figcount_TSCP = figcount_TSCP + 1;
setappdata(0, 'figcount_TSCP', figcount_TSCP);
pcolor(timevect, zhc/hcan, TSCP_variable(:,:,index_TSCP))
shading interp
colorbar
tit             = TSCP_str(index_TSCP);
title(tit, 'FontSize', 12)
ylabel('\bf z / h', 'FontSize', 12)
xlabel('\bf DOY', 'FontSize', 12)

function checkbox9_Callback(hObject, eventdata, handles)


function popupmenu2_Callback(hObject, eventdata, handles)


function popupmenu2_CreateFcn(hObject, eventdata, handles)

% Hint: popupmenu controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end


function popupmenu4_Callback(hObject, eventdata, handles)


function popupmenu4_CreateFcn(hObject, eventdata, handles)

% Hint: popupmenu controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end


function resu_lst_TSF_Callback(hObject, eventdata, handles)


function resu_lst_TSF_CreateFcn(hObject, eventdata, handles)

% Hint: listbox controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end


function resu_lst_DACP_Callback(hObject, eventdata, handles)


function resu_lst_DACP_CreateFcn(hObject, eventdata, handles)

% Hint: listbox controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end


function resu_lst_TSCP_Callback(hObject, eventdata, handles)


function resu_lst_TSCP_CreateFcn(hObject, eventdata, handles)

% Hint: listbox controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end


function resu_lst_DAF_Callback(hObject, eventdata, handles)


function resu_lst_DAF_CreateFcn(hObject, eventdata, handles)

% Hint: listbox controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end


function DAF_chk_grid_Callback(hObject, eventdata, handles)


function TSF_chk_grid_Callback(hObject, eventdata, handles)


function pushbutton24_Callback(hObject, eventdata, handles)


% --- Executes on button press in resu_but_canopy.
function resu_but_canopy_Callback(hObject, eventdata, handles)
% hObject    handle to resu_but_canopy (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)
set(handles.pan_result_canopy,'Visible','on');
set(handles.pan_result_nutrient,'Visible','off');

% --- Executes on button press in resu_but_nutrient.
function resu_but_nutrient_Callback(hObject, eventdata, handles)
% hObject    handle to resu_but_nutrient (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)
set(handles.pan_result_canopy,'Visible','off');
set(handles.pan_result_nutrient,'Visible','on');

% --- Executes on button press in TSFN_chk_grid.
function TSFN_chk_grid_Callback(hObject, eventdata, handles)
% hObject    handle to TSFN_chk_grid (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hint: get(hObject,'Value') returns toggle state of TSFN_chk_grid


% --- Executes on button press in TSFN_chk_hold.
function TSFN_chk_hold_Callback(hObject, eventdata, handles)
% hObject    handle to TSFN_chk_hold (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hint: get(hObject,'Value') returns toggle state of TSFN_chk_hold


% --- Executes on button press in resu_but_plot_TSFN.
function resu_but_plot_TSFN_Callback(hObject, eventdata, handles)
% hObject    handle to resu_but_plot_TSFN (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)
index_TSFN       = get(handles.resu_lst_TSFN,'Value');
TSFN_str         = get(handles.resu_lst_TSFN,'String');
TSFN_variable    = getappdata(0,'TSFN_variable');
figcount_TSFN    = getappdata(0,'figcount_TSFN');
Soil_Depth_str    = getappdata(0,'Soil_Depth');
timevect        = getappdata(0,'timevect');

TSFN_hold        = get(handles.TSFN_chk_hold,'Value');
if TSFN_hold == 1
    figure(figcount_TSFN)
    figcount_TSFN = figcount_TSFN;
    hold on
else
    figure(figcount_TSFN)
    figcount_TSFN = figcount_TSFN+1;
    hold off
end

setappdata(0, 'figcount_TSFN', figcount_TSFN);
plot(timevect,TSFN_variable(:,index_TSFN),'b');
y_lbl_str = TSFN_str(index_TSFN);
xlabel('DOY');
if index_TSFN < 16 || index_TSFN >25
    Depth_info=['to the depth of ',Soil_Depth_str,'m'];
    ylabel([y_lbl_str Depth_info]);
else
    ylabel(y_lbl_str);
end
TSFN_grid        = get(handles.TSFN_chk_grid,'Value');
if TSFN_grid == 1
    grid on
else
    grid off
end

% --- Executes on selection change in resu_lst_TSFN.
function resu_lst_TSFN_Callback(hObject, eventdata, handles)
% hObject    handle to resu_lst_TSFN (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: contents = cellstr(get(hObject,'String')) returns resu_lst_TSFN contents as cell array
%        contents{get(hObject,'Value')} returns selected item from resu_lst_TSFN



% --- Executes during object creation, after setting all properties.
function resu_lst_TSFN_CreateFcn(hObject, eventdata, handles)
% hObject    handle to resu_lst_TSFN (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: listbox controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end



% --- Executes on button press in resu_but_plot_TSSP.
function resu_but_plot_TSSP_Callback(hObject, eventdata, handles)
% hObject    handle to resu_but_plot_TSSP (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)
index_TSSP      = get(handles.resu_lst_TSSP,'Value');
TSSP_str        = get(handles.resu_lst_TSSP,'String');
TSSP_variable   = getappdata(0,'TSSP_variable'); 
timevect        = getappdata(0,'timevect');
%zhc             = getappdata(0,'zhc');
%hcan            = getappdata(0,'hcan');
Soil_Node       = getappdata(0,'Soil_Node');
figcount_TSSP   = getappdata(0,'figcount_TSSP');
dzsmm           = getappdata(0,'dzsmm');
nor_z           = cumsum(dzsmm)./sum(dzsmm);

figure(figcount_TSSP);
figcount_TSSP = figcount_TSSP + 1;
setappdata(0, 'figcount_TSSP', figcount_TSSP);
%pcolor(timevect, zhc/hcan, TSSP_variable(:,:,index_TSSP))
%pcolor(timevect, str2num(Soil_Node)', TSSP_variable(:,:,index_TSSP))
pcolor(timevect, nor_z, TSSP_variable(:,:,index_TSSP))
shading interp
colorbar
tit             = TSSP_str(index_TSSP);
title(tit, 'FontSize', 12)
ylabel('\bf z / max z', 'FontSize', 12)
xlabel('\bf DOY', 'FontSize', 12)
set(gca,'YDir','reverse')

% --- Executes on selection change in resu_lst_TSSP.
function resu_lst_TSSP_Callback(hObject, eventdata, handles)
% hObject    handle to resu_lst_TSSP (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: contents = cellstr(get(hObject,'String')) returns resu_lst_TSSP contents as cell array
%        contents{get(hObject,'Value')} returns selected item from resu_lst_TSSP


% --- Executes during object creation, after setting all properties.
function resu_lst_TSSP_CreateFcn(hObject, eventdata, handles)
% hObject    handle to resu_lst_TSSP (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: listbox controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end


% --- Executes on button press in DAFN_chk_grid.
function DAFN_chk_grid_Callback(hObject, eventdata, handles)
% hObject    handle to DAFN_chk_grid (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hint: get(hObject,'Value') returns toggle state of DAFN_chk_grid


% --- Executes on button press in DAFN_chk_hold.
function DAFN_chk_hold_Callback(hObject, eventdata, handles)
% hObject    handle to DAFN_chk_hold (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hint: get(hObject,'Value') returns toggle state of DAFN_chk_hold


% --- Executes on button press in resu_but_plot_DAFN.
function resu_but_plot_DAFN_Callback(hObject, eventdata, handles)
% hObject    handle to resu_but_plot_DAFN (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)
index_DAFN       = get(handles.resu_lst_DAFN,'Value');
DAFN_str         = get(handles.resu_lst_DAFN,'String');
DAFN_variable    = getappdata(0,'DAFN_variable');
hr              = getappdata(0,'hr');
figcount_DAFN    = getappdata(0,'figcount_DAFN');

DAFN_hold        = get(handles.DAFN_chk_hold,'Value');
if DAFN_hold == 1
    figure(figcount_DAFN);
    figcount_DAFN = figcount_DAFN;
    hold on
else
    figure(figcount_DAFN);
    figcount_DAFN = figcount_DAFN + 1;
    hold off
end

setappdata(0, 'figcount_DAFN', figcount_DAFN);
%errorbar(hr, DAFN_variable(2*index_DAFN-1,:), DAFN_variable(2*index_DAFN,:), '-ok')
errorbar(hr, DAFN_variable(:,2*index_DAFN-1), DAFN_variable(:,2*index_DAFN), '-ok')
y_lbl_str       = DAFN_str(index_DAFN);
xlabel('Hour');
ylabel(y_lbl_str);

DAFN_grid        = get(handles.DAFN_chk_grid,'Value');
if DAFN_grid == 1
    grid on
else
    grid off
end

% --- Executes on selection change in resu_lst_DAFN.
function resu_lst_DAFN_Callback(hObject, eventdata, handles)
% hObject    handle to resu_lst_DAFN (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: contents = cellstr(get(hObject,'String')) returns resu_lst_DAFN contents as cell array
%        contents{get(hObject,'Value')} returns selected item from resu_lst_DAFN


% --- Executes during object creation, after setting all properties.
function resu_lst_DAFN_CreateFcn(hObject, eventdata, handles)
% hObject    handle to resu_lst_DAFN (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: listbox controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end


% --- Executes on button press in resu_but_plot_DASP.
function resu_but_plot_DASP_Callback(hObject, eventdata, handles)
% hObject    handle to resu_but_plot_DASP (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)
index_DASP      = get(handles.resu_lst_DASP,'Value');
DASP_str        = get(handles.resu_lst_DASP,'String');
DASP_variable   = getappdata(0,'DASP_variable'); 
hr              = getappdata(0,'hr');
%zhc             = getappdata(0,'zhc');
%hcan            = getappdata(0,'hcan');
Soil_Node       = getappdata(0,'Soil_Node');
figcount_DASP   = getappdata(0,'figcount_DASP');
dzsmm           = getappdata(0,'dzsmm');
nor_z           = cumsum(dzsmm)./sum(dzsmm);

figure(figcount_DASP);
figcount_DASP = figcount_DASP + 1;
setappdata(0, 'figcount_DASP', figcount_DASP);

pcolor(hr, nor_z, DASP_variable(:,:,index_DASP)')
shading interp
colorbar
tit             = DASP_str(index_DASP);
title(tit, 'FontSize', 12, 'FontWeight', 'b')
ylabel('\bf z / max z', 'FontSize', 12)
xlabel('\bf Hour', 'FontSize', 12)
set(gca,'YDir','reverse')

% --- Executes on selection change in resu_lst_DASP.
function resu_lst_DASP_Callback(hObject, eventdata, handles)
% hObject    handle to resu_lst_DASP (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: contents = cellstr(get(hObject,'String')) returns resu_lst_DASP contents as cell array
%        contents{get(hObject,'Value')} returns selected item from resu_lst_DASP


% --- Executes during object creation, after setting all properties.
function resu_lst_DASP_CreateFcn(hObject, eventdata, handles)
% hObject    handle to resu_lst_DASP (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: listbox controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end
