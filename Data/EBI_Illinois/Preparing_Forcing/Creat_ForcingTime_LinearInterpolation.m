%%-----------------------------------------------------------------------%%
%%<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>%%
%+       Creating Forcing Time Step & Linear Interpolation               +%
%%-----------------------------------------------------------------------%%
%%<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>%%
%                                                                         %
%   This code is used creating forcing time. year, month, day, doy, hour  %
% & Linear interpolation                                                  %
%                                                                         %
%%-----------------------------------------------------------------------%%
%   Created by      :   Dongkook Woo                                      %
%   Date            :   1-21-14                                           %
%%-----------------------------------------------------------------------%%
%%<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>%%
clc
clear all
close all
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                  Input                                  %                              
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 1. Forcing Time
Current_Year=2011; % Year
Time_Step   = 30; % Time step in min

% 2. Linear Interpolation of Data / Should be a colum vector
In_doy=[1:365]'; % Input of doy
%In_Data=[] % Input of Data

% CCS 08 to 11 from PALMS
LAI=[0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0305105689913034,0.0309026706963778,0.0311205182224512,0.0314605683088303,0.0319613665342331,0.0326117947697640,0.0328898653388023,0.0335707515478134,0.0344140678644180,0.0356222949922085,0.0360613428056240,0.0368928536772728,0.0381781943142414,0.0398173034191132,0.0417473465204239,0.0432168096303940,0.0448353141546249,0.0462297722697258,0.0478681996464729,0.0577083751559258,0.0672963112592697,0.0775932222604752,0.0909540131688118,0.102623693645000,0.114674024283886,0.135797083377838,0.162121400237083,0.187992319464684,0.217891946434975,0.260075509548187,0.301816791296005,0.342142730951309,0.390518993139267,0.448134124279022,0.515036821365356,0.582874774932861,0.650486528873444,0.724856853485107,0.810669600963593,0.908417701721191,1.01746845245361,1.11846101284027,1.23110234737396,1.32891440391541,1.44053196907043,1.56994247436523,1.71528220176697,1.79037868976593,1.90197443962097,2.03986787796021,2.20871567726135,2.32751059532166,2.45319581031799,2.58396434783936,2.72020959854126,2.85656809806824,2.95265460014343,3.07691240310669,3.21877288818359,3.38450741767883,3.56632041931152,3.75176000595093,3.95252609252930,4.11068677902222,4.34545087814331,4.54785919189453,4.72054433822632,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.89058923721314,4.80211973190308,4.77796554565430,4.74445962905884,4.69880723953247,4.65115737915039,4.58343648910523,4.54387140274048,4.51456737518311,4.48459815979004,4.44479036331177,4.39955902099609,4.35494470596314,4.31122636795044,4.26877927780151,4.21534347534180,4.16029024124146,4.10198879241943,4.04199647903442,3.99031376838684,3.93801140785217,3.87608170509338,3.83404803276062,3.80991673469543,3.79634165763855,3.78283333778381,3.75250554084778,3.72588109970093,3.67630267143250,3.60819602012634,3.56802964210510,3.53467106819153,3.50299930572510,3.45830798149109,3.39417695999146,3.31728458404541,3.24331331253052,3.18721389770508,3.14147734642029,3.13249731063843,3.12736153602600,3.11512637138367,3.10286974906921,3.08347272872925,3.07819819450378,3.07629346847534,3.06528377532959,3.05838966369629,3.05838966369629,3.05214142799377,3.05214142799377,3.05214142799377,3.05214142799377,3.04556941986084,3.01395702362061,2.97536277770996,2.92812538146973,2.88481974601746,2.84542822837830,2.80538415908813,2.77321815490723,2.77321815490723,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0304687544703484,0.0309486817568541,0.0313221625983715,0.0316870138049126,0.0321806520223618,0.0329368971288204,0.0339723601937294,0.0353059880435467,0.0370260104537010,0.0387410223484039,0.0406268313527107,0.0418966785073280,0.0436077341437340,0.0456487536430359,0.0469162166118622,0.0567356124520302,0.0671418085694313,0.0789203941822052,0.0917869806289673,0.103369183838367,0.108948923647404,0.116295970976353,0.128381669521332,0.142909809947014,0.158420577645302,0.176349833607674,0.196105942130089,0.214633584022522,0.244739159941673,0.279016166925430,0.323638409376144,0.369374334812164,0.414374351501465,0.459374368190765,0.504374384880066,0.572126984596252,0.658499896526337,0.752552449703217,0.838214933872223,0.960787951946259,1.10039496421814,1.25240206718445,1.40832161903381,1.57126224040985,1.73154330253601,1.87839376926422,2.01977729797363,2.13985443115234,2.24504542350769,2.37523698806763,2.53189778327942,2.57689785957336,2.68736791610718,2.82511687278748,2.95109677314758,3.02851247787476,3.16097140312195,3.27900409698486,3.39126586914063,3.53486132621765,3.69639444351196,3.85400891304016,3.97411727905273,4.14697933197022,4.27255868911743,4.39207172393799,4.53725004196167,4.70744800567627,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.89135980606079,4.72005558013916,4.66506290435791,4.61482667922974,4.56944751739502,4.51882743835449,4.48312759399414,4.45905494689941,4.43032503128052,4.41040086746216,4.38766193389893,4.37591266632080,4.36019420623779,4.33849287033081,4.30729293823242,4.28920793533325,4.27704238891602,4.27160787582398,4.27160787582398,4.27160787582398,4.27063274383545,4.27063274383545,4.27063274383545,4.27063274383545,4.27063274383545,4.27063274383545,4.27063274383545,4.25686836242676,4.23399448394775,4.20709943771362,4.18223714828491,4.16530847549439,4.16530847549439,4.14551305770874,4.12978506088257,4.12305212020874,4.10801076889038,4.08288478851318,4.05378150939941,4.05378150939941,4.05378150939941,4.04331922531128,4.04331922531128,4.03953123092651,4.03953123092651,4.02774524688721,3.99789953231812,3.96858000755310,3.93710851669312,3.92354416847229,3.92354416847229,3.92354416847229,3.92354416847229,3.90348529815674,3.90082550048828,3.90082550048828,3.90082550048828,3.90082550048828,3.90082550048828,3.90082550048828,3.89893364906311,3.89534783363342,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0315554440021515,0.0331756062805653,0.0348668470978737,0.0368257537484169,0.0397595427930355,0.0432062894105911,0.0471949949860573,0.0520564615726471,0.0552999228239059,0.0618902519345284,0.0689086914062500,0.0722968354821205,0.0774526968598366,0.0834377333521843,0.0907817929983139,0.0966318696737289,0.102399878203869,0.107219249010086,0.111727468669415,0.119153246283531,0.129070147871971,0.140539497137070,0.151213526725769,0.161448955535889,0.171847224235535,0.180304408073425,0.192913457751274,0.211369663476944,0.234470143914223,0.260428637266159,0.295821249485016,0.340333312749863,0.402538895606995,0.477370530366898,0.572993755340576,0.690979599952698,0.833744764328003,0.972587466239929,1.17211139202118,1.38151121139526,1.56301569938660,1.78090989589691,2.01567721366882,2.27225184440613,2.49465084075928,2.80734682083130,2.98353672027588,3.26793193817139,3.46954178810120,3.76094603538513,4.01468753814697,4.17843580245972,4.33959150314331,4.45363044738770,4.58474063873291,4.77739620208740,5.00500535964966,5.22137498855591,5.22137498855591,5.22137498855591,5.22137498855591,5.22137451171875,5.22137260437012,5.22136926651001,5.22136116027832,5.22134685516357,5.22131872177124,5.22125291824341,5.22112894058228,5.22095823287964,5.22076463699341,5.22047233581543,5.21999549865723,5.21918630599976,5.21799945831299,5.21628093719482,5.21384716033936,5.21069955825806,5.20667028427124,5.20181560516357,5.19715213775635,5.19190216064453,5.18449974060059,5.17440986633301,5.16145896911621,5.14793682098389,5.13185930252075,5.11517286300659,5.09487056732178,5.07588195800781,5.05751609802246,5.03277826309204,4.99906301498413,4.95227956771851,4.90553474426270,4.84442186355591,4.78744411468506,4.72166776657105,4.67674541473389,4.64628791809082,4.59978294372559,4.51953840255737,4.43569850921631,4.37432384490967,4.30817222595215,4.23612308502197,4.14495754241943,4.04384613037109,3.90363407135010,3.76021289825439,3.60097670555115,3.45964312553406,3.33700180053711,3.16464662551880,2.98443102836609,2.71055507659912,2.38075780868530,2.12996315956116,1.74665021896362,1.45482492446899,1.34395802021027,1.28262364864349,1.21221709251404,1.05618250370026,0.816333591938019,0.575050532817841,0.399177074432373,0.356939435005188,0.356939435005188,0.356939435005188,0.301167279481888,0.110141940414906,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0306642483919859,0.0308498702943325,0.0309064034372568,0.0310600772500038,0.0312546044588089,0.0316109061241150,0.0323637574911118,0.0333785712718964,0.0345970652997494,0.0360114872455597,0.0374586209654808,0.0390504896640778,0.0402708426117897,0.0407774038612843,0.0414390563964844,0.0424634739756584,0.0444850027561188,0.0471267774701119,0.0606973692774773,0.0710070878267288,0.0796913951635361,0.0921379849314690,0.108581073582172,0.121730819344521,0.139007017016411,0.159798264503479,0.184782415628433,0.207387611269951,0.239061281085014,0.277147233486176,0.309204965829849,0.350194603204727,0.390931487083435,0.434513717889786,0.495200961828232,0.562867820262909,0.631352782249451,0.693311333656311,0.776315927505493,0.869799077510834,0.948526203632355,1.01440775394440,1.08278381824493,1.16812419891357,1.26743531227112,1.38031840324402,1.49584770202637,1.62622821331024,1.77390384674072,1.89925372600555,2.07449436187744,2.24913740158081,2.42741084098816,2.62338280677795,2.84344482421875,3.05271244049072,3.26627588272095,3.51082110404968,3.77983045578003,4.10444450378418,4.41366767883301,4.65519094467163,4.91398906707764,4.91398906707764,4.91398906707764,4.91398906707764,4.91398906707764,4.91398906707764,4.91398906707764,4.91398906707764,4.91398906707764,4.91398906707764,4.91398906707764,4.91398906707764,4.91398906707764,4.91398906707764,4.91398906707764,4.91398906707764,4.91398906707764,4.91398906707764,4.91398906707764,4.91398906707764,4.91398906707764,4.91398906707764,4.91398906707764,4.91398906707764,4.91398906707764,4.91398906707764,4.91398906707764,4.91398906707764,4.91398906707764,4.91398906707764,4.91398906707764,4.91398906707764,4.91398906707764,4.91398906707764,4.91398906707764,4.88005113601685,4.81448507308960,4.74408578872681,4.67322206497192,4.60055732727051,4.53431797027588,4.42970848083496,4.35397338867188,4.27334785461426,4.17091560363770,4.09875774383545,4.01849031448364,3.93614840507507,3.82110118865967,3.68621921539307,3.55259513854980,3.42846608161926,3.35336899757385,3.30520391464233,3.26530122756958,3.21504712104797,3.16163539886475,3.09436774253845,3.01782202720642,2.92513632774353,2.82749247550964,2.72910594940186,2.68798756599426,2.66598677635193,2.62635183334351,2.56563234329224,2.49792695045471,2.42397832870483,2.35614228248596,2.28311514854431,2.23873448371887,2.19892716407776,2.15552020072937,2.11855816841126,2.07923865318298,2.04207873344421,1.98959541320801,1.92856681346893,1.89020240306854,1.88310205936432,1.86048996448517,1.80656135082245,1.73789179325104,1.65136671066284,1.55820536613464,1.45915484428406,1.36655092239380,1.28030788898468,1.19727516174316,1.10177981853485,1.02989304065704,0.971622765064240,0.938462078571320,0.911409437656403,0.866023421287537,0.856822729110718,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477,0.0299999993294477];
LAI08=LAI(1:365);
LAI09=LAI(365+1:365*2);
LAI10=LAI(365*2+1:365*3);
LAI11=LAI(365*3+1:365*4);

%2008
%In_doy=[0:1/24:366-1/24]';
%W2008=importdata('weather_2008_AndyMetdata.txt');
%PPT08=W2008.data(:,5);

In_Data=LAI08;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                        Estimating Time                                  %                              
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Total number of days in a year
Totday=yeardays(Current_Year);

% Number of days in a month
Num_Jan     = 31; % Number of days in Jan
if Totday == 365
    Num_Feb     = 28; % Number of days in Feb
elseif Totday == 366
    Num_Feb     = 29; % Number of days in Feb
end
Num_Mar     = 31; % Number of days in Mar
Num_Apr     = 30; % Number of days in Apr
Num_May     = 31; % Number of days in May

Num_Jun     = 30; % Number of days in Jun
Num_Jul     = 31; % Number of days in Jul
Num_Aug     = 31; % Number of days in Aug
Num_Sep     = 30; % Number of days in Sep
Num_Oct     = 31; % Number of days in Oct

Num_Nov     = 30; % Number of days in Nov
Num_Dec     = 31; % Number of days in Dec

% last id
Num_a_day = 24*60/Time_Step;
last_id=Totday*Num_a_day;

% year
year = ones(last_id,1).*Current_Year;

% month
month = [ones(Num_Jan.*Num_a_day,1).*1; ones(Num_Feb.*Num_a_day,1).*2; ones(Num_Mar.*Num_a_day,1).*3; ones(Num_Apr.*Num_a_day,1).*4; ...
    ones(Num_May.*Num_a_day,1).*5; ones(Num_Jun.*Num_a_day,1).*6; ones(Num_Jul.*Num_a_day,1).*7; ones(Num_Aug.*Num_a_day,1).*8; ...
    ones(Num_Sep.*Num_a_day,1).*9; ones(Num_Oct.*Num_a_day,1).*10; ones(Num_Nov.*Num_a_day,1).*11; ones(Num_Dec.*Num_a_day,1).*12];
 
% day
day_Jan = repmat(1:Num_Jan,Num_a_day,1);
day_Feb = repmat(1:Num_Feb,Num_a_day,1);
day_Mar = repmat(1:Num_Mar,Num_a_day,1);
day_Apr = repmat(1:Num_Apr,Num_a_day,1);
day_May = repmat(1:Num_May,Num_a_day,1);

day_Jun = repmat(1:Num_Jun,Num_a_day,1);
day_Jul = repmat(1:Num_Jul,Num_a_day,1);
day_Aug = repmat(1:Num_Aug,Num_a_day,1);
day_Sep = repmat(1:Num_Sep,Num_a_day,1);
day_Oct = repmat(1:Num_Oct,Num_a_day,1);

day_Nov = repmat(1:Num_Nov,Num_a_day,1);
day_Dec = repmat(1:Num_Dec,Num_a_day,1);
day=[day_Jan(:); day_Feb(:); day_Mar(:); day_Apr(:); day_May(:); ...
    day_Jun(:); day_Jul(:); day_Aug(:); day_Sep(:); day_Oct(:); ...
    day_Nov(:); day_Dec(:)];

% doy
doy_step=Totday/last_id;
doy=[0:doy_step:Totday]'; doy(end)=[];
%doy=[1+doy_step:doy_step:Totday+1+doy_step]'; doy(end)=[];

% Hour
hour_step=Time_Step/60;
last_hour_test=hour_step.*(1:60*24);
last_hour_ind=last_hour_test<24;
last_hour=max(last_hour_test(last_hour_ind));
%hour_a_day=0:hour_step:last_hour;
hour_a_day=hour_step:hour_step:last_hour;
hour_a_day=[hour_a_day 0];

hour_Jan = repmat(hour_a_day,1,Num_Jan);
hour_Feb = repmat(hour_a_day,1,Num_Feb);
hour_Mar = repmat(hour_a_day,1,Num_Mar);
hour_Apr = repmat(hour_a_day,1,Num_Apr);
hour_May = repmat(hour_a_day,1,Num_May);

hour_Jun = repmat(hour_a_day,1,Num_Jun);
hour_Jul = repmat(hour_a_day,1,Num_Jul);
hour_Aug = repmat(hour_a_day,1,Num_Aug);
hour_Sep = repmat(hour_a_day,1,Num_Sep);
hour_Oct = repmat(hour_a_day,1,Num_Oct);

hour_Nov = repmat(hour_a_day,1,Num_Nov);
hour_Dec = repmat(hour_a_day,1,Num_Dec);
hour=[hour_Jan(:); hour_Feb(:); hour_Mar(:); hour_Apr(:); ...
    hour_May(:); hour_Jun(:); hour_Jul(:); hour_Aug(:); ...
    hour_Sep(:); hour_Oct(:); hour_Nov(:); hour_Dec(:)];

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                         Linear Interpolation                            %                              
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Out_Data=interp1(In_doy,In_Data,In_doy(1):doy_step:(In_doy(end)+(Num_a_day-1)*doy_step));
Out_Data=Out_Data(:);

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                 Output                                  %                              
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 1. Forcing Time
year; month; day; doy; hour;

% 2. Interpolation
Out_Data;