%%-----------------------------------------------------------------------%%
%%<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>%%
%+       Creating Forcing Time Step & Linear Interpolation               +%
%%-----------------------------------------------------------------------%%
%%<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>%%
%                                                                         %
%   This code is used creating forcing time. year, month, day, doy, hour  %
% & Linear interpolation                                                  %
%                                                                         %
%%-----------------------------------------------------------------------%%
%   Created by      :   Dongkook Woo                                      %
%   Date            :   1-21-14                                           %
%%-----------------------------------------------------------------------%%
%%<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>%%
clc
clear all
close all
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                  Input                                  %                              
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 1. Forcing Time
Current_Year=2004; % Year
Time_Step   = 30; % Time step in min

% 2. Linear Interpolation of Data / Should be a colum vector
In_doy=[1:365]'; % Input of doy
%In_Data=[] % Input of Data

% Corn 2011 from PALMS
%leaf_carbon=[0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00028571428,0.00032160795,0.00032974945,0.00033637811,0.00038441148,0.00041802914,0.00044198646,0.00049309799,0.00053628901,0.00058440154,0.00064467255,0.00071841484,0.00081015390,0.00085023092,0.00085582992,0.00088591175,0.00090301858,0.00093217619,0.0010055123,0.0010844108,0.0012575147,0.0013414521,0.0015709563,0.0019111064,0.0020666181,0.0024510548,0.0029806439,0.0036055124,0.0042226054,0.0052242363,0.0059692012,0.0074262875,0.0090725292,0.010106130,0.011078563,0.013029189,0.014755813,0.016533734,0.017910590,0.019869678,0.022943333,0.026137531,0.027860265,0.030696627,0.034777980,0.039055407,0.042108141,0.047502466,0.053854678,0.060778905,0.065265194,0.072590329,0.080557801,0.090045705,0.10073291,0.11048031,0.11751664,0.12848130,0.13925821,0.15008576,0.16007128,0.17001425,0.17828855,0.18442830,0.18442830,0.18442830,0.18442830,0.18442830,0.18442830,0.18442830,0.18442830,0.18442830,0.18442830,0.18442830,0.18442830,0.18442830,0.18442830,0.18442830,0.18442830,0.18442830,0.18442830,0.18442830,0.18442830,0.18442830,0.18442830,0.18442830,0.18442830,0.18442830,0.18442830,0.18442830,0.18442830,0.18442830,0.18442830,0.18442830,0.18442830,0.18442830,0.18442830,0.18442830,0.18314937,0.18067853,0.17802556,0.17535508,0.17261674,0.17012052,0.16617835,0.16332430,0.16028595,0.15642582,0.15370658,0.15068173,0.14757872,0.14324319,0.13816021,0.13312463,0.12844688,0.12561686,0.12380178,0.12229805,0.12040424,0.11839144,0.11585648,0.11297189,0.10947905,0.10579938,0.10209171,0.10054218,0.099713087,0.098219462,0.095931269,0.093379818,0.090593092,0.088036716,0.085284710,0.083612241,0.082112119,0.080476344,0.079083443,0.077601701,0.076201342,0.074223526,0.071923681,0.070477933,0.070210360,0.069358230,0.067325950,0.064738162,0.061477493,0.057966739,0.054234054,0.050744306,0.047494266,0.044365205,0.040766496,0.038057469,0.035861574,0.034611925,0.033592455,0.031882100,0.031535376,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478,0.00037684478;].*1000'; % [g/m2]
%grain_carbon=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.012921900,0.021508459,0.026438735,0.035216801,0.045789696,0.049698826,0.061309792,0.074414425,0.086664170,0.097934790,0.10850839,0.11947186,0.12827516,0.13789895,0.14694393,0.15602385,0.16430342,0.16844557,0.17699045,0.18651767,0.19464043,0.19917002,0.20178442,0.20734949,0.21658862,0.22539425,0.23362960,0.23526761,0.24416047,0.25282490,0.26105505,0.26140401,0.26290202,0.26947412,0.27741799,0.28096426,0.28813922,0.29324576,0.29628879,0.30223513,0.30287391,0.30879232,0.31447428,0.32184315,0.32994145,0.33652112,0.34365466,0.35084921,0.35730451,0.36387169,0.37007570,0.37531960,0.37985942,0.38482082,0.38806018,0.39137563,0.39274374,0.39704701,0.40174964,0.40419656,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373,0.40652373;].*1000'; % [g/m2]
%stem_carbon=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.2099723e-05,1.4815407e-05,1.7024962e-05,3.3036085e-05,4.4241973e-05,5.2252159e-05,6.9417198e-05,8.3974854e-05,0.00010021547,0.00012056773,0.00014543867,0.00017636632,0.00018983324,0.00019170275,0.00020174892,0.00020748453,0.00021733383,0.00024218111,0.00026891645,0.00032820634,0.00035721582,0.00043756113,0.00055861555,0.00061463844,0.00075537409,0.00095297187,0.0011913911,0.0014312002,0.0018271271,0.0020783250,0.0025673625,0.0031211539,0.0034691009,0.0037965190,0.0044552363,0.0050385990,0.0056387414,0.0061033657,0.0067658182,0.0078056101,0.0088822749,0.0094615407,0.010414738,0.011788661,0.013230857,0.014261397,0.016080305,0.018224068,0.020564754,0.022100696,0.024654640,0.027480997,0.030907460,0.034843955,0.038517773,0.041227784,0.045546215,0.049902625,0.054409869,0.058723904,0.063174129,0.066978529,0.076741330,0.090267561,0.098917641,0.11401453,0.12366228,0.13612990,0.15040427,0.16572516,0.18032236,0.19464234,0.19784448,0.21074094,0.22534710,0.23787287,0.25092596,0.25818694,0.26909199,0.28312764,0.29593512,0.30933791,0.32076526,0.33401570,0.34245470,0.34853262,0.36076528,0.36847275,0.38054708,0.39205694,0.40451878,0.41459817,0.42319858,0.43478048,0.44757462,0.45886898,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443,0.46751443;].*1000'; % [g/m2]
%root_carbon=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.1981908e-05,1.4659705e-05,1.6826125e-05,3.2769276e-05,4.3870157e-05,5.1731055e-05,6.8635272e-05,8.2864877e-05,9.8704404e-05,0.00011856256,0.00014285771,0.00017309152,0.00018598560,0.00018734131,0.00019684700,0.00020201122,0.00021119689,0.00023513129,0.00026086025,0.00031816537,0.00034549294,0.00042190391,0.00053589279,0.00058723777,0.00071674434,0.00089633092,0.0011094048,0.0013203016,0.0016656001,0.0019097426,0.0023903821,0.0029330971,0.0032699858,0.0035855568,0.0042271889,0.0047923289,0.0053729187,0.0058179582,0.0064565279,0.0074658156,0.0085116420,0.0090630660,0.0099843610,0.011318995,0.012715973,0.013700602,0.015463955,0.017542729,0.019807788,0.021257089,0.023665316,0.026295329,0.029447554,0.033017904,0.036278278,0.038612269,0.042322163,0.045984514,0.049687151,0.053121198,0.056569226,0.059429992,0.063237585,0.066441491,0.068419270,0.072001122,0.074212760,0.077122353,0.080475047,0.084079839,0.087494105,0.090829812,0.091380745,0.094350435,0.097738832,0.10059857,0.10358214,0.10511150,0.10754645,0.11075631,0.11365077,0.11668593,0.11921961,0.12220150,0.12397403,0.12515223,0.12786379,0.12943819,0.13209850,0.13461061,0.13735351,0.13949411,0.14125961,0.14376464,0.14656547,0.14898418,0.15073496,0.15032256,0.15205498,0.15286984,0.15464310,0.15685961,0.15740637,0.15987448,0.16270874,0.16532181,0.16768330,0.16986431,0.17213668,0.17386352,0.17579047,0.17756766,0.17934871,0.18092507,0.18146418,0.18310100,0.18497857,0.18650037,0.18712096,0.18726170,0.18813871,0.18993057,0.19160932,0.19314110,0.19302163,0.19471370,0.19634411,0.19786164,0.19740742,0.19724131,0.19834244,0.19978303,0.20012178,0.20136553,0.20208949,0.20229630,0.20322737,0.20283082,0.20375347,0.20461455,0.20589443,0.20735291,0.20842825,0.20963894,0.21086155,0.21189626,0.21295606,0.21392229,0.21464618,0.21519230,0.21584220,0.21606040,0.21629700,0.21604678,0.21653003,0.21711165,0.21712853,0.21711546,0.21706650,0.21647261,0.21588035,0.21528971,0.21470068,0.21411327,0.21352746,0.21294326,0.21236065,0.21177964,0.21120022,0.21062239,0.21004613,0.20947145,0.20889834,0.20832680,0.20775683,0.20718841,0.20662156,0.20605625,0.20549248,0.20493026,0.20436957,0.20381042,0.20325281,0.20269671,0.20214213,0.20158908,0.20103754,0.20048751,0.19993898,0.19939196,0.19884643,0.19830239,0.19775984,0.19721878,0.19667919,0.19614108,0.19560444,0.19506927,0.19453557,0.19400333,0.19347253,0.19294320,0.19241531,0.19188887,0.19136387,0.19084030,0.19031817,0.18979746,0.18927819,0.18876033,0.18824388,0.18772885,0.18721522,0.18670301,0.18619220,0.18568279,0.18517476,0.18466812,0.18416287,0.18365900,0.18315652,0.18265541,0.18215567,0.18165730,0.18116029,0.18066464,0.18017036,0.17967741,0.17918582,0.17869557,0.17820667,0.17771910,0.17723286;].*1000'; % [g/m2]
%leaf_area_index=[0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.030664248,0.030849870,0.030906403,0.031060077,0.031254604,0.031610906,0.032363757,0.033378571,0.034597065,0.036011487,0.037458621,0.039050490,0.040270843,0.040777404,0.041439056,0.042463474,0.044485003,0.047126777,0.060697369,0.071007088,0.079691395,0.092137985,0.10858107,0.12173082,0.13900702,0.15979826,0.18478242,0.20738761,0.23906128,0.27714723,0.30920497,0.35019460,0.39093149,0.43451372,0.49520096,0.56286782,0.63135278,0.69331133,0.77631593,0.86979908,0.94852620,1.0144078,1.0827838,1.1681242,1.2674353,1.3803184,1.4958477,1.6262282,1.7739038,1.8992537,2.0744944,2.2491374,2.4274108,2.6233828,2.8434448,3.0527124,3.2662759,3.5108211,3.7798305,4.1044445,4.4136677,4.6551909,4.9139891,4.9139891,4.9139891,4.9139891,4.9139891,4.9139891,4.9139891,4.9139891,4.9139891,4.9139891,4.9139891,4.9139891,4.9139891,4.9139891,4.9139891,4.9139891,4.9139891,4.9139891,4.9139891,4.9139891,4.9139891,4.9139891,4.9139891,4.9139891,4.9139891,4.9139891,4.9139891,4.9139891,4.9139891,4.9139891,4.9139891,4.9139891,4.9139891,4.9139891,4.9139891,4.8800511,4.8144851,4.7440858,4.6732221,4.6005573,4.5343180,4.4297085,4.3539734,4.2733479,4.1709156,4.0987577,4.0184903,3.9361484,3.8211012,3.6862192,3.5525951,3.4284661,3.3533690,3.3052039,3.2653012,3.2150471,3.1616354,3.0943677,3.0178220,2.9251363,2.8274925,2.7291059,2.6879876,2.6659868,2.6263518,2.5656323,2.4979270,2.4239783,2.3561423,2.2831151,2.2387345,2.1989272,2.1555202,2.1185582,2.0792387,2.0420787,1.9895954,1.9285668,1.8902024,1.8831021,1.8604900,1.8065614,1.7378918,1.6513667,1.5582054,1.4591548,1.3665509,1.2803079,1.1972752,1.1017798,1.0298930,0.97162277,0.93846208,0.91140944,0.86602342,0.85682273,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999,0.029999999;]';
CN_above=[22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	55.9726160257996	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22	22];
CN_below=[27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27	27];
TBMla=[0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0.00814150553196669	0.00662865932099521	0.0480333692394197	0.0336176599375904	0.0239573128055781	0.0511115358676761	0.0431910157203674	0.0481125316582620	0.0602710060775280	0.0737422960810363	0.0917390570975840	0.0400770222768188	0.00559899490326643	0.0300818355754018	0.0171068240888417	0.0291576143354177	0.0733361230231822	0.0788985053077340	0.173103879205883	0.0839374260976911	0.229504192247987	0.340150087140501	0.155511661432683	0.384436687454581	0.529589131474495	0.624868553131819	0.617092940956354	1.00163090974092	0.744964927434921	1.45708629861474	1.64624163880944	1.03360041975975	0.972433015704155	1.95062626153231	1.72662455588579	1.77792087197304	1.37685611844063	1.95908732712269	3.07365506887436	3.19419801235199	1.72273442149162	2.83636152744293	4.08135354518890	233.945635147393	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0];
TBMroot=[0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0.00170971616171300	0.00139201845740899	0.0100870075402781	0.00705970858689398	0.00503103568917140	0.0107334225322120	0.00907011330127716	0.0101036316482350	0.0126569112762809	0.0154858821770176	0.0192652019904926	0.00841617467813194	0.00117578892968595	0.00631718547083437	0.00359243305865675	0.00612309901043773	0.0154005858348683	0.0165686861146241	0.0363518146332353	0.0176268594805151	0.0481958803720772	0.0714315182995051	0.0326574489008635	0.0807317043654621	0.111213717609644	0.131222396157682	0.129589517600834	0.210342491045594	0.156442634761333	0.305988122709096	0.345710744149983	0.217056088149548	0.204210933297873	0.409631514921784	0.362591156736016	0.373363383114338	0.289139784872532	0.411408338695765	0.645467564463615	0.670781582593918	0.361774228513241	0.595635920763016	0.857084244489670	217.066496610641	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0];
DEM=[0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0.00229134736307219	0.000517735081490551	0.000420992452606863	0.00305970318687491	0.00213930212994891	0.00152313631978599	0.00325581852005550	0.00275017997736616	0.00306356168880360	0.00383847158633885	0.00469581810004110	0.00584194692443046	0.00253969554178012	0.000338092083388155	0.00189879476856746	0.00107126050708402	0.00184141771550744	0.00466357214488773	0.00501658512969295	0.0110494033298608	0.00534544045891864	0.0146966299080777	0.0218446370289357	0.00997068303307460	0.0247838138889160	0.0342517643172546	0.0405518086267178	0.0401425561978623	0.0653869570378761	0.0473895422451007	0.0927645079969129	0.104817763493489	0.0656718544580006	0.0617354251305537	0.124190501324311	0.109830098955974	0.113033564322860	0.0873632673355149	0.124528370511629	0.195658303057917	0.203149175734260	0.109072121849739	0.180067075899532	0.259478582633167	0.271919115350917	0.193628832753536	0.342982896123368	0.404005853302669	0.440422023416452	0.285024657782472	0.467755558599678	0.510031047459031	0.609197975212827	0.688304518294530	0.629415628688334	0.454665893899653	0.712904288371988	0.703287807324114	0.709775468529578	0.658103777306439	0.659119089797598	0.549988937948252	0.594431316553177	0.360199289946987	0.227714411752640	0.402244283229956	0.254191110393602	0.330395404502599	0.379069453478629	0.407093772426710	0.387114686242069	0.379254533440088	0.0775852044785214	0.340278960244253	0.386316526444485	0.329587340266183	0.343589910666609	0.186301292101670	0.284913413262288	0.369516301932283	0.335903928160627	0.351745412849046	0.297896388207300	0.347051911172525	0.216343258574222	0.152169846893908	0.318865376241184	0.195942479819246	0.314139411657685	0.298571407742987	0.324118454073811	0.259267657618686	0.218965599191090	0.299595536573388	0.332197440770584	0.291263981758814	0.219224454902894	0.230745810620855	0.217493008703809	0.118219241463718	0.222425451271469	0.270891595728491	0.0900556296415545	0.298747029211741	0.338980384834155	0.315522460597583	0.288720714042413	0.269589635069896	0.279934964329875	0.221156387147025	0.243219805816691	0.227336791471318	0.228103710402138	0.206231299574486	0.0939329981669394	0.213207769474221	0.239666319832487	0.201409956723308	0.103869318451387	0.0518977122195425	0.131856779089784	0.231347281074945	0.219417083919225	0.203790293957130	0.0292498774553867	0.221468160156649	0.215105292416678	0.203169822748743	0.00623128160336816	0.0267499675286788	0.158140065228956	0.195207757706003	0.0758716478641032	0.174187641086387	0.118000222784619	0.0619988502502859	0.140667196275354	0.0114067204617468	0.139856727379162	0.133354014875979	0.178987775626752	0.198628327106596	0.157319918562681	0.172223270573186	0.173754151885921	0.153594134763451	0.156521315282761	0.146570872549711	0.120450275441624	0.101294065803414	0.112665623043516	0.0659264874984298	0.0679667230565356	0.0244302001267588	0.0947411905204748	0.105515958508919	0.0443198309966942	0.0415562461834665	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0];

In_Data=DEM;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                        Estimating Time                                  %                              
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Total number of days in a year
Totday=yeardays(Current_Year);

% Number of days in a month
Num_Jan     = 31; % Number of days in Jan
if Totday == 365
    Num_Feb     = 28; % Number of days in Feb
elseif Totday == 366
    Num_Feb     = 29; % Number of days in Feb
end
Num_Mar     = 31; % Number of days in Mar
Num_Apr     = 30; % Number of days in Apr
Num_May     = 31; % Number of days in May

Num_Jun     = 30; % Number of days in Jun
Num_Jul     = 31; % Number of days in Jul
Num_Aug     = 31; % Number of days in Aug
Num_Sep     = 30; % Number of days in Sep
Num_Oct     = 31; % Number of days in Oct

Num_Nov     = 30; % Number of days in Nov
Num_Dec     = 31; % Number of days in Dec

% last id
Num_a_day = 24*60/Time_Step;
last_id=Totday*Num_a_day;

% year
year = ones(last_id,1).*Current_Year;

% month
month = [ones(Num_Jan.*Num_a_day,1).*1; ones(Num_Feb.*Num_a_day,1).*2; ones(Num_Mar.*Num_a_day,1).*3; ones(Num_Apr.*Num_a_day,1).*4; ...
    ones(Num_May.*Num_a_day,1).*5; ones(Num_Jun.*Num_a_day,1).*6; ones(Num_Jul.*Num_a_day,1).*7; ones(Num_Aug.*Num_a_day,1).*8; ...
    ones(Num_Sep.*Num_a_day,1).*9; ones(Num_Oct.*Num_a_day,1).*10; ones(Num_Nov.*Num_a_day,1).*11; ones(Num_Dec.*Num_a_day,1).*12];
 
% day
day_Jan = repmat(1:Num_Jan,Num_a_day,1);
day_Feb = repmat(1:Num_Feb,Num_a_day,1);
day_Mar = repmat(1:Num_Mar,Num_a_day,1);
day_Apr = repmat(1:Num_Apr,Num_a_day,1);
day_May = repmat(1:Num_May,Num_a_day,1);

day_Jun = repmat(1:Num_Jun,Num_a_day,1);
day_Jul = repmat(1:Num_Jul,Num_a_day,1);
day_Aug = repmat(1:Num_Aug,Num_a_day,1);
day_Sep = repmat(1:Num_Sep,Num_a_day,1);
day_Oct = repmat(1:Num_Oct,Num_a_day,1);

day_Nov = repmat(1:Num_Nov,Num_a_day,1);
day_Dec = repmat(1:Num_Dec,Num_a_day,1);
day=[day_Jan(:); day_Feb(:); day_Mar(:); day_Apr(:); day_May(:); ...
    day_Jun(:); day_Jul(:); day_Aug(:); day_Sep(:); day_Oct(:); ...
    day_Nov(:); day_Dec(:)];

% doy
doy_step=Totday/last_id;
doy=[0:doy_step:Totday]'; doy(end)=[];

% Hour
hour_step=Time_Step/60;
last_hour_test=hour_step.*(1:60*24);
last_hour_ind=last_hour_test<24;
last_hour=max(last_hour_test(last_hour_ind));
hour_a_day=0:hour_step:last_hour;

hour_Jan = repmat(hour_a_day,1,Num_Jan);
hour_Feb = repmat(hour_a_day,1,Num_Feb);
hour_Mar = repmat(hour_a_day,1,Num_Mar);
hour_Apr = repmat(hour_a_day,1,Num_Apr);
hour_May = repmat(hour_a_day,1,Num_May);

hour_Jun = repmat(hour_a_day,1,Num_Jun);
hour_Jul = repmat(hour_a_day,1,Num_Jul);
hour_Aug = repmat(hour_a_day,1,Num_Aug);
hour_Sep = repmat(hour_a_day,1,Num_Sep);
hour_Oct = repmat(hour_a_day,1,Num_Oct);

hour_Nov = repmat(hour_a_day,1,Num_Nov);
hour_Dec = repmat(hour_a_day,1,Num_Dec);
hour=[hour_Jan(:); hour_Feb(:); hour_Mar(:); hour_Apr(:); ...
    hour_May(:); hour_Jun(:); hour_Jul(:); hour_Aug(:); ...
    hour_Sep(:); hour_Oct(:); hour_Nov(:); hour_Dec(:)];

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                         Linear Interpolation                            %                              
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Out_Data=interp1(In_doy,In_Data,In_doy(1):doy_step:(In_doy(end)+(Num_a_day-1)*doy_step));
Out_Data=Out_Data(:);

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                 Output                                  %                              
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 1. Forcing Time
year; month; day; doy; hour;

% 2. Interpolation
Out_Data;